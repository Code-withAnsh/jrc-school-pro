/*! For license information please see AdobeMessagingClient.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AdobeMessagingClient=t():e.AdobeMessagingClient=t()}(self,()=>(()=>{var e={45:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-2.png"},48:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-7.png"},66:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-5.png"},246:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-japac-4.png"},249:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-6.png"},278:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-1.png"},279:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-8.png"},335:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-japac-5.png"},494:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-9.png"},505:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-japac-3.png"},544:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-14.png"},571:(e,t,n)=>{"use strict";e.exports=n.p+"assets/cc_appicon.png"},582:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-12.png"},611:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-4.png"},660:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-10.png"},665:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-15.png"},680:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-japac-2.png"},715:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-japac-1.png"},804:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-3.png"},871:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-13.png"},889:(e,t,n)=>{"use strict";e.exports=n.p+"assets/Lightroom.png"},909:(e,t,n)=>{"use strict";e.exports=n.p+"assets/sales-avatar-11.png"},993:(e,t,n)=>{var o={"./Lightroom.png":889,"./cc_appicon.png":571,"./jp/sales-avatar-japac-1.png":715,"./jp/sales-avatar-japac-2.png":680,"./jp/sales-avatar-japac-3.png":505,"./jp/sales-avatar-japac-4.png":246,"./jp/sales-avatar-japac-5.png":335,"./sales-avatar-1.png":278,"./sales-avatar-10.png":660,"./sales-avatar-11.png":909,"./sales-avatar-12.png":582,"./sales-avatar-13.png":871,"./sales-avatar-14.png":544,"./sales-avatar-15.png":665,"./sales-avatar-2.png":45,"./sales-avatar-3.png":804,"./sales-avatar-4.png":611,"./sales-avatar-5.png":66,"./sales-avatar-6.png":249,"./sales-avatar-7.png":48,"./sales-avatar-8.png":279,"./sales-avatar-9.png":494,"AdobeMessagingClient/assets/img/Lightroom.png":889,"AdobeMessagingClient/assets/img/cc_appicon.png":571,"AdobeMessagingClient/assets/img/jp/sales-avatar-japac-1.png":715,"AdobeMessagingClient/assets/img/jp/sales-avatar-japac-2.png":680,"AdobeMessagingClient/assets/img/jp/sales-avatar-japac-3.png":505,"AdobeMessagingClient/assets/img/jp/sales-avatar-japac-4.png":246,"AdobeMessagingClient/assets/img/jp/sales-avatar-japac-5.png":335,"AdobeMessagingClient/assets/img/sales-avatar-1.png":278,"AdobeMessagingClient/assets/img/sales-avatar-10.png":660,"AdobeMessagingClient/assets/img/sales-avatar-11.png":909,"AdobeMessagingClient/assets/img/sales-avatar-12.png":582,"AdobeMessagingClient/assets/img/sales-avatar-13.png":871,"AdobeMessagingClient/assets/img/sales-avatar-14.png":544,"AdobeMessagingClient/assets/img/sales-avatar-15.png":665,"AdobeMessagingClient/assets/img/sales-avatar-2.png":45,"AdobeMessagingClient/assets/img/sales-avatar-3.png":804,"AdobeMessagingClient/assets/img/sales-avatar-4.png":611,"AdobeMessagingClient/assets/img/sales-avatar-5.png":66,"AdobeMessagingClient/assets/img/sales-avatar-6.png":249,"AdobeMessagingClient/assets/img/sales-avatar-7.png":48,"AdobeMessagingClient/assets/img/sales-avatar-8.png":279,"AdobeMessagingClient/assets/img/sales-avatar-9.png":494};function i(e){var t=a(e);return n(t)}function a(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}i.keys=function(){return Object.keys(o)},i.resolve=a,e.exports=i,i.id=993}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var i=o.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=o[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})();var o={};return(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,a(o.key),o)}}function i(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,n||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}n.r(o),n.d(o,{default:()=>go});var r={INIT_SUCCESS_CALLBACK:"INIT_SUCCESS_CALLBACK",INIT_ERROR_CALLBACK:"INIT_ERROR_CALLBACK",SIGN_IN_CALLBACK:"SIGN_IN_CALLBACK",GET_CONTEXT_CALLBACK:"GET_CONTEXT_CALLBACK",TRIGGER_ON_READY_CALLBACKS:"TRIGGER_ON_READY_CALLBACKS",OPEN_URL_ACTION_CALLBACK:"OPEN_URL_ACTION_CALLBACK"},s=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"sendMessageToHost",function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{switch(e){case t.hostCallbacks.INIT_SUCCESS_CALLBACK:t.adbmsg_initSuccessCallback(n);break;case t.hostCallbacks.INIT_ERROR_CALLBACK:t.adbmsg_initErrorCallback(n);break;case t.hostCallbacks.SIGN_IN_CALLBACK:t.adbmsg_signCallback();break;case t.hostCallbacks.OPEN_URL_ACTION_CALLBACK:t.adbmsg_openURLActionCallback(n);break;case t.hostCallbacks.GET_CONTEXT_CALLBACK:return t.adbmsg_getContextCallback();case t.hostCallbacks.TRIGGER_ON_READY_CALLBACKS:for(var o=0;o<t.adbmsg_onReadyCallbacks.length;o++)t.adbmsg_onReadyCallbacks[o]()}}catch(e){}return null}),i(this,"initializeCallbacks",function(){t.adbmsg_initSuccessCallback=zn.initJson.callbacks.initCallback||t.adbmsg_initSuccessCallback,t.adbmsg_initErrorCallback=zn.initJson.callbacks.initErrorCallback||t.adbmsg_initErrorCallback,t.adbmsg_signCallback=zn.initJson.callbacks.signInProvider||t.adbmsg_signCallback,t.adbmsg_getContextCallback=zn.initJson.callbacks.getContextCallback||t.adbmsg_getContextCallback,t.adbmsg_onReadyCallbacks.push(zn.initJson.callbacks.onReadyCallback||function(){}),t.adbmsg_openURLActionCallback=zn.initJson.callbacks.openURLActionCallback||t.adbmsg_openURLActionCallback}),i(this,"registerForOnReadyCallback",function(e){e&&(zn.isAdobeMessagingClientReady?e():t.adbmsg_onReadyCallbacks.push(e))}),this.adbmsg_initSuccessCallback=function(){},this.adbmsg_initErrorCallback=function(){},this.adbmsg_signCallback=function(){},this.adbmsg_getContextCallback=function(){},this.adbmsg_openURLActionCallback=function(){},this.adbmsg_onReadyCallbacks=[]},(n=[{key:"hostCallbacks",get:function(){return r}}])&&t(e.prototype,n),o&&t(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,o}();const l=new s;function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,d(o.key),o)}}function u(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==c(t)?t:t+""}const m=new(u(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.CLIENT_DEV_PATH="https://dev-client.messaging.adobe.com",this.CLIENT_DEVOPS_PATH="https://devops-client.messaging.adobe.com",this.CLIENT_QE_PATH="https://qe-client.messaging.adobe.com",this.CLIENT_STAGE_PATH="https://stage-client.messaging.adobe.com",this.CLIENT_INTEGRATION_PATH="https://integration-client.messaging.adobe.com",this.CLIENT_PROD_PATH="https://client.messaging.adobe.com",this.CLIENT_AUTHORING_PATH="https://authoring-client.messaging.adobe.com",this.DEFAULT_SERVER_URL="https://server.messaging.adobe.com",this.LOG_API_PATH="/core/v1/log",this.INIT_API_PATH="/core/v1/messaging/init",this.USER_CONSENT_PATH="/core/v1/messaging/updateUserConsent",this.SET_POPUP_COOKIE_PATH="/core/v1/messaging/setPopUpCookie",this.MINIMIZE_POPUP_PATH="/core/v1/messaging/minimizePopup"}));function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,b(o.key),o)}}function b(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=g(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==g(t)?t:t+""}const v=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"debug",value:function(){if(zn.msgdebug){var e=Array.prototype.slice.call(arguments);console.debug.apply(console,e)}}},{key:"error",value:function(){if(zn.msgdebug){var e=Array.prototype.slice.call(arguments);console.error.apply(console,e)}}},{key:"warn",value:function(){if(zn.msgdebug){var e=Array.prototype.slice.call(arguments);console.warn.apply(console,e)}}},{key:"log",value:function(){if(zn.msgdebug){var e=Array.prototype.slice.call(arguments);console.info.apply(console,e)}}},{key:"info",value:function(){if(zn.msgdebug){var e=Array.prototype.slice.call(arguments);console.info.apply(console,e)}}}],t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,r,s=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(s.push(o.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function P(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,E(o.key),o)}}function w(e,t,n){return(t=E(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=y(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:t+""}var S=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),w(this,"getRandomAvatarUrl",function(){var e=15,n="/assets/sales-avatar-";t.isAsianLocale()&&(e=5,n="/assets/sales-avatar-japac-");var o=Math.floor(Math.random()*e)+1;return t.getJarvisClientRootUrlByEnv()+n+o+".png"}),w(this,"isAsianLocale",function(){var e=new Set(["ja_jp","ko_kr","zh_cn","zh_tw","zh_hk"]),t=zn.serverInitResponse.uiFallbackLocale;return!!t&&e.has(t.toLowerCase())}),w(this,"getPopupNotification",function(){return t.getJarvisClientRootUrlByEnv()+"/assets/notification.wav"}),w(this,"getECIDFromAMCVCookie",function(){try{var e=document.cookie.split(";").map(function(e){return e.trim()}).find(function(e){return e.startsWith("AMCV")});if(!e)return v.warn("[GlobalUtils] No AMCV cookie found"),null;var t=h(e.split("="),2)[1],n=decodeURIComponent(t).split("|"),o=n.indexOf("MCMID");return-1!==o&&n[o+1]?(v.log("[GlobalUtils] ECID from AMCV cookie:",n[o+1]),n[o+1]):(v.warn("[GlobalUtils] MCMID not found in AMCV cookie"),null)}catch(e){return v.error("[GlobalUtils] Error parsing AMCV cookie:",e),null}})},t=[{key:"isEmpty",value:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return JSON.stringify(e)===JSON.stringify({})}},{key:"getClientAppId",value:function(){return zn.appid}},{key:"getClientVersion",value:function(){return zn.appver}},{key:"isHidden",value:function(e){return"none"===window.getComputedStyle(e).display}},{key:"getUUID",value:function(){var e,t,n="";for(e=0;e<32;e++)t=16*Math.random()|0,8!=e&&12!=e&&16!=e&&20!=e||(n+="-"),n+=(12==e?4:16==e?3&t|8:t).toString(16);return n}},{key:"getClientFileByEnv",value:function(){return"local"===zn.env?"test.js":"AdobeMessagingClient.js"}},{key:"getJarvisClientRootUrlByEnv",value:function(){if("local"===zn.env)return".";var e="";if("dev"===zn.env)e=m.CLIENT_DEV_PATH;else if("devops"===zn.env)e=m.CLIENT_DEVOPS_PATH;else if("qe"===zn.env)e=m.CLIENT_QE_PATH;else if("integration"===zn.env)e=m.CLIENT_INTEGRATION_PATH;else if("stage"===zn.env)e=m.CLIENT_STAGE_PATH;else if("prod"===zn.env)e=m.CLIENT_PROD_PATH;else{if("authoring"!==zn.env)return void v.error("Wrong environment");e=m.CLIENT_AUTHORING_PATH}return e+"/"+this.getClientVersion()}}],t&&P(e.prototype,t),n&&P(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();const A=new S;function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function T(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,U(o.key),o)}}function U(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=I(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:t+""}var k=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"createXMLHttp",value:function(){if(void 0!==("undefined"==typeof XMLHttpRequest?"undefined":I(XMLHttpRequest)))return new XMLHttpRequest;if(window.ActiveXObject)for(var e=["MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp","Microsoft.XMLHttp"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(e){}}},{key:"ajax",value:function(e,t,n){var o=this.createXMLHttp();for(var i in o.open(n.type,n.url,!0),n.headers)n.headers.hasOwnProperty(i)&&o.setRequestHeader(i,n.headers[i]);n.withCredentials&&(o.withCredentials=!0),zn.initJson.accessToken&&""!==zn.initJson.accessToken.trim()&&o.setRequestHeader("Authorization",zn.initJson.accessToken),n.timeout?o.timeout=n.timeout:o.timeout=3e4,o.onload=function(){200===o.status?o.responseType&&""!==o.responseType?e&&e(o.response):e&&e(o.responseText):t&&t(o.status)},o.onerror=function(){t&&t(400)},o.ontimeout=function(){t&&t(408)},n.data?o.send(JSON.stringify(n.data)):o.send()}}],t&&T(e.prototype,t),n&&T(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();const M=new k;function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,R(o.key),o)}}function L(e,t,n){return(t=R(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e){var t=function(e,t){if("object"!=O(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=O(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==O(t)?t:t+""}const D=new(function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),L(this,"publishToServer",function(e,n){var o={type:"post",url:zn.initConfig.serverUrl?zn.initConfig.serverUrl+m.LOG_API_PATH:m.DEFAULT_SERVER_URL+m.LOG_API_PATH,headers:{"Content-Type":"application/json","x-api-key":zn.initJson.clientId}};o.data=t.getLog(e,n),M.ajax(null,null,o)}),L(this,"getLog",function(e,t){return{time:(new Date).getTime(),level:e,serverSessionGuid:zn.serverSessionGuid,conversationId:zn.conversationId,message:t}}),this.maskKeys=["message","accessToken"]},t=[{key:"processLog",value:function(e,t){try{var n=t.map(function(e){return JSON.stringify(e)}).join(" ");this.publishToServer(e,n)}catch(e){}}},{key:"log",value:function(){var e=Array.prototype.slice.call(arguments);this.processLog("INFO",e)}},{key:"info",value:function(){var e=Array.prototype.slice.call(arguments);this.processLog("INFO",e)}},{key:"debug",value:function(){var e=Array.prototype.slice.call(arguments);this.processLog("DEBUG",e)}},{key:"warn",value:function(){var e=Array.prototype.slice.call(arguments);this.processLog("WARN",e)}},{key:"error",value:function(){var e=Array.prototype.slice.call(arguments);this.processLog("ERROR",e)}},{key:"maskValues",value:function(e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(this.maskValues(e[n]));return t}if("object"===O(e))for(var o in e)if(e.hasOwnProperty(o))if("string"==typeof e[o]||"number"==typeof e[o]||"boolean"==typeof e[o])for(var i=0;i<this.maskKeys.length;i++)o===this.maskKeys[i]&&(e[o]="~masked~");else e[o]=this.maskValues(e[o]);return e}},{key:"mask",value:function(e){try{var t=JSON.parse(JSON.stringify(e));return this.maskValues(t)}catch(e){return"Mask error on UI"}}}],t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());var j,N=new Uint8Array(16);function x(){if(!j&&!(j="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return j(N)}const B=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const W=function(e){return"string"==typeof e&&B.test(e)};for(var H=[],J=0;J<256;++J)H.push((J+256).toString(16).substr(1));const F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(H[e[t+0]]+H[e[t+1]]+H[e[t+2]]+H[e[t+3]]+"-"+H[e[t+4]]+H[e[t+5]]+"-"+H[e[t+6]]+H[e[t+7]]+"-"+H[e[t+8]]+H[e[t+9]]+"-"+H[e[t+10]]+H[e[t+11]]+H[e[t+12]]+H[e[t+13]]+H[e[t+14]]+H[e[t+15]]).toLowerCase();if(!W(n))throw TypeError("Stringified UUID is invalid");return n};const G=function(e,t,n){var o=(e=e||{}).random||(e.rng||x)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=o[i];return t}return F(o)};function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,r,s=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(s.push(o.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach(function(t){Z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Z(e,t,n){return(t=Y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Y(o.key),o)}}function Y(e){var t=function(e,t){if("object"!=z(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=z(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==z(t)?t:t+""}const Q=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"initialize",value:function(e,t,n){this.project=e,this.env=t,this.ingestType=n,this.timeZoneString="";var o=-(new Date).getTimezoneOffset();o>=0?this.timeZoneString="+":(this.timeZoneString="-",o*=-1),this.timeZoneString+=("0"+parseInt(o/60)).slice(-2)+("0"+o%60).slice(-2)}},{key:"setAuthorization",value:function(e,t){this.userGuid=e,this.auth=t}},{key:"pad",value:function(e){return e<10?"0"+e:e}},{key:"getDateTimeString",value:function(){var e=new Date;return e.getFullYear()+"-"+this.pad(e.getMonth()+1)+"-"+this.pad(e.getDate())+"T"+this.pad(e.getHours())+":"+this.pad(e.getMinutes())+":"+this.pad(e.getSeconds())+"."+(e.getMilliseconds()/1e3).toFixed(3).slice(2,5)+this.timeZoneString}},{key:"sendEvent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];zn.mnmMode||(void 0!==zn.userConsent?!1!==zn.userConsent&&this.populateAndSendAnalyticsEvent(e,t):zn.analyticsPipeline.push({inEventData:e,shouldSendOverCallback:t}))}},{key:"populateAndSendAnalyticsEvent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n={events:[]},o=this.getDateTimeString(),i=G(),a={};a.project=this.project,a.environment=this.env,a.ingesttype=this.ingestType,a.time=o,a.data=q(q(q(q({},{}),zn.getCommonAnalyticsParams()),e),{"event.dts_end":o,"event.guid":i}),zn.analyticsInfo&&zn.analyticsInfo["content.mimetype"]&&(a.data["content.mimetype"]=zn.analyticsInfo["content.mimetype"]),zn.analyticsInfo&&zn.analyticsInfo["env.fw.name"]&&(a.data["env.fw.name"]=zn.analyticsInfo["env.fw.name"]),zn.analyticsInfo&&zn.analyticsInfo["env.com.version"]&&(a.data["env.com.version"]=zn.analyticsInfo["env.com.version"]),zn.userProfile.userGuid&&(a.data["event.user_guid"]=zn.userProfile.userGuid),zn.userProfile.serviceCode&&(a.data["user.service_code"]=zn.userProfile.serviceCode),zn.userProfile.serviceLevel&&(a.data["user.service_level"]=zn.userProfile.serviceLevel),zn.vendorConversationId&&(a.data["event.context_guid"]=zn.vendorConversationId),zn.initJson.appid&&(a.data["source.name"]=zn.initJson.appid),zn.initJson.clientId&&(a.data["source.client_id"]=zn.initJson.clientId),zn.initJson.language&&zn.initJson.region&&(a.data["event.language"]=zn.initJson.language+"_"+zn.initJson.region),zn.clientSessionId&&(a.data["event.session_guid"]=zn.clientSessionId),zn.initJson.cookies&&zn.initJson.cookies.mcid&&(a.data["event.visitor_guid"]=zn.initJson.cookies.mcid),zn.initJson.context&&zn.initJson.context.orgId&&(a.data["event.org_guid"]=zn.initJson.context.orgId),!a.data["content.status"]&&zn.skillName&&(a.data["content.status"]=zn.skillName),zn.serverInitResponse&&zn.serverInitResponse.cookieGuid&&(a.data["source.device"]=zn.serverInitResponse.cookieGuid),zn.userConsent?n.events.push(a):n.events.push(this.filterAnalyticsEvents(a));var r=M.createXMLHttp();"prod"===this.env?r.open("post","https://cc-api-data.adobe.io/ingest/",!0):"prod"===zn.initJson.analyticsServerEnv?(r.open("post","https://cc-api-data.adobe.io/ingest/",!0),a.environment="prod"):r.open("post","https://cc-api-data-stage.adobe.io/ingest/",!0),navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox")>0&&(r.responseType="text"),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("x-api-key","messaging-web-service"),zn.initJson.accessToken&&r.setRequestHeader("Authorization",zn.initJson.accessToken),r.timeout=5e3;var s=e["event.workflow"]+" - "+e["event.subcategory"]+" - "+e["event.type"]+" - "+e["event.subtype"];r.onload=function(){r.status>=200&&r.status<400?v.log("Successfully sent event: "+s):v.warn("Error in sending event: "+s+" status: "+r.status+" Response: "+r.responseText)},r.onerror=function(){v.warn("Some Network error occurred while sending event: "+s)},r.ontimeout=function(){v.warn("Time out while sending event: "+s)},r.send(JSON.stringify(n)),zn.initJson.callbacks.analyticsCallback&&t&&zn.initJson.callbacks.analyticsCallback(n)}catch(e){v.warn("Exception while sending analytics events",e)}}},{key:"filterAnalyticsEvents",value:function(e){var t=[],n=Object.fromEntries(Object.entries(e.data).filter(function(e){var n=V(e,2),o=n[0];return n[1],t.includes(o)}));return e.data=n,e}},{key:"flushAnalyticsPipeline",value:function(){var e=this;zn.userConsent&&zn.analyticsPipeline.forEach(function(t){e.populateAndSendAnalyticsEvent(t.inEventData,t.shouldSendOverCallback)}),zn.analyticsPipeline=[]}}],t&&$(e.prototype,t),n&&$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,oe(o.key),o)}}function ne(e,t,n){return(t=oe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e){var t=function(e,t){if("object"!=ee(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=ee(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ee(t)?t:t+""}var ie={SIGNIN:"SIGNIN",SIGNOUT:"SIGNOUT",SET_CONTEXT:"SET_CONTEXT",HOST_DATA:"HOST_DATA",CUSTOMER_AUTH_DATA_RESPONSE:"CUSTOMER_AUTH_DATA_RESPONSE",UPDATE_ACCESS_TOKEN:"UPDATE_ACCESS_TOKEN",WINDOW_OPENED:"WINDOW_OPENED",WINDOW_MINIMIZED:"WINDOW_MINIMIZED",CLIENT_FOCUS_STATE:"CLIENT_FOCUS_STATE",UPDATE_USER_CONSENT:"UPDATE_USER_CONSENT",POP_OUT_STATE:"POP_OUT_STATE",START_SERVICE_CONNECTION:"START_SERVICE_CONNECTION",INITIAL_DATA:"INITIAL_DATA",REFRESH_MESSAGE_UI:"REFRESH_MESSAGE_UI",CHANGE_COOKIE_GUID:"CHANGE_COOKIE_GUID",UPDATE_UI_THEME:"UPDATE_UI_THEME",SET_EXPANDED:"SET_EXPANDED",UPDATE_USER_PRIVACY_CONSENT:"UPDATE_USER_PRIVACY_CONSENT"},ae=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ne(this,"updateUrlParameter",function(e,t,n){n||(n=window.location.href);var o,i=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi");if(i.test(n))return null!=t?n.replace(i,"$1"+e+"="+t+"$2$3"):(o=n.split("#"),n=o[0].replace(i,"$1$3").replace(/(&|\?)$/,""),void 0!==o[1]&&null!==o[1]&&(n+="#"+o[1]),n);if(null!=t){var a=-1!==n.indexOf("?")?"&":"?";return o=n.split("#"),n=o[0]+a+e+"="+t,void 0!==o[1]&&null!==o[1]&&(n+="#"+o[1]),n}return n}),ne(this,"addDataToObj",function(e,t,n){for(var o=e,i=t.split("."),a=i.length,r=0;r<a-1;r++){var s=i[r];o[s]||(o[s]={}),o=o[s]}o[i[a-1]]=n}),ne(this,"receiveMessage",function(e){try{var n=e.origin||e.originalEvent.origin,o=zn.getMessagingUIURL(zn.mnmMode),i="";if(o.startsWith("https://")||o.startsWith("")){var a=o.split("/");i=a[0]+"//"+a[2]}if(i!==n)return void v.log("Ignoring message received as event origin : ",n," and expected origin: ",o," do not match");var r=e.data;try{if(0===!r.msgType.indexOf("adbmsg_"))return void v.log("Received data in post message that do not start with valid prefix, therefore ignoring")}catch(e){return void v.log("Exception in processing post Message received: ",e)}if(zn.mnmMode)return void t.readZeonMessage(r);switch(r.msgType){case"adbmsg_POPOUT":Xt.handlePopOut();break;case"adbmsg_POPIN":Xt.handlePopIn();break;case"adbmsg_SIGNIN":var s=r.message,c=encodeURIComponent(JSON.stringify(s));window.adobeid&&window.adobeid.api_parameters&&window.adobeid.api_parameters.authorize&&window.adobeid.api_parameters.authorize.redirect_uri?t.addDataToObj(window,"adobeid.api_parameters.authorize.redirect_uri",t.updateUrlParameter("jarvisData",c,window.adobeid.api_parameters.authorize.redirect_uri)):window.adobeid&&window.adobeid.redirect_uri?t.addDataToObj(window,"adobeid.api_parameters.authorize.redirect_uri",t.updateUrlParameter("jarvisData",c,window.adobeid.redirect_uri)):t.addDataToObj(window,"adobeid.api_parameters.authorize.redirect_uri",t.updateUrlParameter("jarvisData",c,window.location.href)),l.sendMessageToHost(l.hostCallbacks.SIGN_IN_CALLBACK);break;case"adbmsg_MNM_SWITCH":zn.mnmMode=!0;var p=r.message;zn.zeonData=p,zn.zeonData.userConsent=zn.userConsent,zn.zeonData.imsUserProfile&&(zn.zeonData.imsUserProfile=JSON.parse(zn.zeonData.imsUserProfile)),zn.zeonData.imsAccessToken=zn.initJson.accessToken,Xt.renderZeonElement();break;case"adbmsg_NEW_MESSAGE":Xt.showConversationMarker(!0);break;case"adbmsg_LOAD_COMPLETE":v.log("Client message received: LOAD_COMPLETE or CONV_LOAD_COMPLETE"),t.handledLoadComplete=!0,Xt.handleDragWidth("DECREASE"),t.sendMessageToMessagingUI(t.uiMessagesEnum.INITIAL_DATA,Xt.getMessageUIInitPayload());break;case"adbmsg_OPEN_URL_BY_HOST":v.log("Client message received: OPEN_URL_BY_HOST"),l.sendMessageToHost(l.hostCallbacks.OPEN_URL_ACTION_CALLBACK,r.message);break;case"adbmsg_INITIAL_DATA_HANDLED":v.log("Client message received: INITIAL_DATA_HANDLED"),Xt.removeSpinner(),t.initialServerPoliciesApplied?zn.initJson.lazyLoad?(D.info("Going to create session because of lazy load functionality for appid: ",zn.initJson.appid," and client id: ",zn.initJson.clientId),zn.initJson.lazyLoad=!1,Xt.adbmsgCta.style.display="none",Xt.adbmsgContentContainer.style.display="block",t.sendMessageToMessagingUI(t.uiMessagesEnum.START_SERVICE_CONNECTION)):D.error("Received invalid initial data handled for appid: ",zn.initJson.appid," and client id: ",zn.initJson.clientId):Xt.applyInitialServerPolicies();break;case"adbmsg_CONV_CLOSED":zn.conversationActive=!1,zn.leConversationId="",zn.skillName="",Xt.showConversationMarker(!1),zn.initJson.callbacks.chatStateCallback&&zn.initJson.callbacks.chatStateCallback(r.message);break;case"adbmsg_MINIMIZE_WINDOW":Xt.handleMinimizeMessagingWindow();break;case"adbmsg_EXPAND_WINDOW_FROM_CLIENT":Xt.handleExpandWindow("EXPAND");break;case"adbmsg_COMPRESS_WINDOW_FROM_CLIENT":Xt.handleExpandWindow("COMPRESS");break;case"adbmsg_CLOSE_WINDOW":Xt.handleDragWidth("INCREASE"),Xt.handleCloseMessagingWindow(!0);break;case"adbmsg_SEND_ANALYTICS_TO_HOST":zn.initJson.callbacks.analyticsCallback&&zn.initJson.callbacks.analyticsCallback(r.message);break;case"adbmsg_CONVERSATION_ID":zn.leConversationId=r.message;break;case"adbmsg_VENDOR_CONVERSATION_ID":zn.vendorConversationId=r.message;break;case"adbmsg_CLIENT_SESSION_ID":zn.clientSessionId=r.message;break;case"adbmsg_CHAT_STATE":r&&r.message&&"open"===r.message.chatState&&(zn.conversationActive=!0,Xt.handleDragWidth("DECREASE")),zn.initJson.callbacks.chatStateCallback&&zn.initJson.callbacks.chatStateCallback(r.message);break;case"adbmsg_OPEN_WINDOW_WS":Xt.handleWSCreationForClientWindow();break;case"adbmsg_HANDLE_DRAG_WIDTH":Xt.handleDragWidth(r.message);break;case"adbmsg_SKILL_NAME":zn.skillName=r.message;break;case"adbmsg_ACCESS_TOKEN_FAILURE":zn.initJson.appType&&"desktop"===zn.initJson.appType.toLowerCase()&&l.sendMessageToHost(l.hostCallbacks.INIT_ERROR_CALLBACK,401)}}catch(e){v.error(e)}}),ne(this,"readZeonMessage",function(e){try{switch(e.msgType){case"adbmsg_INITIAL_DATA_HANDLED":v.log("Zeon message received: INITIAL_DATA_HANDLED");break;case"adbmsg_CUSTOMER_AUTH_DATA_REQUEST":t.sendMessageToZeon(t.uiMessagesEnum.INITIAL_DATA,zn.zeonData);break;case"adbmsg_CONV_STARTED":v.log("Zeon message received: CONV_STARTED"),zn.conversationActive=!0;break;case"adbmsg_CONV_CLOSED":case"adbmsg_ZEON_ERROR":zn.mnmMode=!1,zn.conversationActive=!1,Xt.closeZeon();break;case"adbmsg_NEW_MESSAGE":Xt.showConversationMarker(!0);break;case"adbmsg_MINIMIZE_WINDOW":Xt.handleMinimizeMessagingWindow(!1,!0)}}catch(e){v.error(e)}}),ne(this,"sendMessageToMessagingUI",function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t.handledLoadComplete){var i=zn.getMessagingUIURL(),a="adbmsgui_".concat(e);try{document.getElementsByClassName("adbmsgContentIframe")[0].contentWindow.postMessage({msgType:a,message:n},i),o&&Xt.poppedWindow&&Xt.poppedWindow.postMessage({msgType:a,message:n},i)}catch(e){v.log(e)}}else v.warn("Not sending message to msgUI as it is currently not loaded")}),ne(this,"sendMessageToZeon",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=zn.getMessagingUIURL(!0),o="adbmsgui_".concat(e);try{document.getElementsByClassName("adbmsgContentIframeMnm")[0].contentWindow.postMessage({msgType:o,message:t},n)}catch(e){v.log(e)}}),ne(this,"startListening",function(){window.addEventListener("message",t.receiveMessage,!1)}),ne(this,"stopListening",function(){}),ne(this,"setInitialServerPoliciesApplied",function(e){t.initialServerPoliciesApplied=e}),ne(this,"getInitialServerPoliciesApplied",function(){return t.initialServerPoliciesApplied}),ne(this,"getLoadCompleteState",function(){return t.handledLoadComplete}),ne(this,"setLoadCompletedState",function(e){t.handledLoadComplete=e}),this.handledLoadComplete=!1,this.initialServerPoliciesApplied=!1},(t=[{key:"uiMessagesEnum",get:function(){return ie}}])&&te(e.prototype,t),n&&te(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();const re=new ae;function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function le(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,pe(o.key),o)}}function ce(e,t,n){return t&&le(e.prototype,t),n&&le(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function pe(e){var t=function(e,t){if("object"!=se(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=se(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==se(t)?t:t+""}const ue=new(ce(function e(){var t,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,o=function(e,t){t?window.open(e,t):window.open(e,"_blank")},(n=pe(n="openLinkDirectly"))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o}));function de(e){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(e)}function me(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ge(o.key),o)}}function ge(e){var t=function(e,t){if("object"!=de(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=de(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==de(t)?t:t+""}const fe=new(function(){return e=function e(){var t,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=document.createElement(e);return t&&t.split(",").forEach(function(e){return o.classList.add(e)}),n&&n.appendChild(o),o},(n=ge(n="createElement"))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o},(t=[{key:"addFocusRingHandling",value:function(e){e.addEventListener("focus",function(){e.classList.add("focus-ring")},!1),e.addEventListener("blur",function(){e.classList.remove("focus-ring")},!1)}}])&&me(e.prototype,t),n&&me(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function ve(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,he(o.key),o)}}function ye(e,t,n){return t&&ve(e.prototype,t),n&&ve(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function he(e){var t=function(e,t){if("object"!=be(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=be(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==be(t)?t:t+""}const Ce=new(ye(function e(){var t,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,o=function(e){var t=M.createXMLHttp(),n=zn.initConfig.serverUrl;t.open("post",n+m.MINIMIZE_POPUP_PATH,!0),t.setRequestHeader("Content-Type","application/json"),zn.initJson.accessToken&&""!==zn.initJson.accessToken.trim()&&t.setRequestHeader("Authorization",zn.initJson.accessToken),t.setRequestHeader("x-api-key",zn.initJson.appid),t.withCredentials=!0,t.timeout=3e4,t.onload=function(){t.status>=200&&t.status<400?v.info("The call to server to minimize the popup succeeded"):v.info("The call to server to minimize the popup failed")},t.onerror=function(){v.info("The call to server to minimize the popup failed")},t.ontimeout=function(){v.info("The call to server to minimize the popup timed out")},t.send(e)},(n=he(n="minimizePopupClicked"))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o}));function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function we(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Se(o.key),o)}}function Ee(e,t,n){return(t=Se(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Se(e){var t=function(e,t){if("object"!=Pe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Pe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Pe(t)?t:t+""}var Ae=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ee(this,"addCampaignAnalyticsToEvent",function(e,t){t&&(t.variationId&&(e["exp.variation_id"]=t.variationId),t.actionBlockId&&(e["exp.action_block_id"]=t.actionBlockId),t.campaignId&&(e["exp.campaign_id"]=t.campaignId),t.responseGUID&&(e["exp.response_guid"]=t.responseGUID),t.surfaceId&&(e["exp.surface_id"]=t.surfaceId),t.containerId&&(e["exp.container_id"]=t.containerId),t.controlGroupId&&(e["exp.control_group_id"]=t.controlGroupId),t.treatmentId&&(e["exp.treatment_id"]=t.treatmentId))}),Ee(this,"handleButtonClick",function(e,n){e.preventDefault(),e.stopPropagation();var o={"event.workflow":"EngagementPopUP","event.type":"click","event.subtype":n.key,"content.name":t.engagementPopUpModel.analyticsInfo.analyticsId};if(t.addCampaignAnalyticsToEvent(o,t.engagementPopUpModel.analyticsInfo.campaignAnalyticsData),Q.sendEvent(o),"closePopUp"===n.action){_e.hideEngagementPopUp(),Xt.renderCTAasPerPolicy();var i={engagementPopUpId:t.engagementPopUpModel.analyticsInfo.analyticsId,type:"engagement"};_e.setCookieByServerForPopUpClicked(JSON.stringify(i)),Ce.minimizePopupClicked(JSON.stringify(i))}else if("openURL"===n.action){Xt.renderCTAasPerPolicy();var a="".concat(n.url,"#sa_src=web-messaging");ue.openLinkDirectly(a,"_blank");var r={engagementPopUpId:t.engagementPopUpModel.analyticsInfo.analyticsId};_e.setCookieByServerForPopUpClicked(JSON.stringify(r))}else"openChat"===n.action?Xt.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"engagementPopUp",sourceText:"button"}):"openCustomizedChat"===n.action&&Xt.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"engagementPopUp",sourceText:"button",customGreet:"paymentUpdateRBI"})}),Ee(this,"renderBody",function(e,n){if(t.engagementPopUpModel.iconURL){var o=fe.createElement("div","adbmsgEngagementPopUpAvatar",e);fe.createElement("img","adbmsgEngagementPopUpAvatarImg",o).src=t.engagementPopUpModel.iconURL}var i;i=n&&"jarvis"===n.theme?fe.createElement("div","adbmsgEngagementPopUpBodyPara,adbmsgEngagementPopUpBodyParaWhiteColor",e):fe.createElement("div","adbmsgEngagementPopUpBodyPara,adbmsgEngagementPopUpBodyParaBlackColor",e),(n&&"jarvis"===n.theme?fe.createElement("div","adbmsgEngagementPopUpBodyParaTitleJarvis",i):fe.createElement("div","adbmsgEngagementPopUpBodyParaTitle",i)).innerHTML=t.engagementPopUpModel.content,t.engagementPopUpModel.body&&(fe.createElement("div","adbmsgEngagementPopUpBodyParaDescription",i).innerHTML=t.engagementPopUpModel.body)}),Ee(this,"renderControls",function(e,n){var o;o=n&&"jarvis"===n.theme?fe.createElement("div","adbmsgEngagementPopUpControlsJarvis,spectrum-ButtonGroup",e):fe.createElement("div","adbmsgEngagementPopUpControls,spectrum-ButtonGroup",e);for(var i=function(){var e=t.engagementPopUpModel.footer.buttons[a],n=null;n="primary"===e.variant?t.createPrimaryButton(o,t.engagementPopUpModel.theme):t.createSecondaryButton(o,t.engagementPopUpModel.theme);var i=fe.createElement("span","spectrum-Button-label",n);fe.addFocusRingHandling(n),i.innerHTML=e.label,n.setAttribute("aria-label",e.label),n.addEventListener&&n.addEventListener("click",function(n){t.handleButtonClick(n,e)})},a=0;a<t.engagementPopUpModel.footer.buttons.length;a++)i()}),Ee(this,"createPrimaryButton",function(e,t){return"jarvis"===t?fe.createElement("button","spectrum-Button,spectrum-Button--primary,spectrum-ButtonGroup-item,adbmsgEngagement-button",e):fe.createElement("button","spectrum-Button,spectrum-Button--primary,spectrum-ButtonGroup-item",e)}),Ee(this,"createSecondaryButton",function(e,t){return"jarvis"===t?fe.createElement("button","spectrum-Button,spectrum-Button--secondary,spectrum-Button--quiet,spectrum-ButtonGroup-item,adbmsgEngagement-button",e):fe.createElement("button","spectrum-Button,spectrum-Button--secondary,spectrum-Button--quiet,spectrum-ButtonGroup-item",e)}),Ee(this,"addPopUpToDOM",function(e,n){t.engagementPopUpModel=e,t.adbmsgEngagementPopUpContent=fe.createElement("div","adbmsgEngagementPopUpContent",n),t.renderHeader(t.adbmsgEngagementPopUpContent,e);var o=fe.createElement("div","adbmsgEngagementPopUpInnerContent",t.adbmsgEngagementPopUpContent);t.renderInnerContent(o,e);var i={"event.workflow":"EngagementPopUP","event.type":"render","content.name":t.engagementPopUpModel.analyticsInfo.analyticsId};t.addCampaignAnalyticsToEvent(i,t.engagementPopUpModel.analyticsInfo.campaignAnalyticsData),Q.sendEvent(i)}),this.engagementPopUpModel=null},t=[{key:"renderHeader",value:function(e,t){var n=this;if("jarvis"===t.theme){var o=fe.createElement("div","adbmsgEngagementHeader",e),i=(fe.createElement("div","adbmsgEngagementPopUpLogoOldImg",o),fe.createElement("div","adbmsgEngagementPopUpCloseDiv",o)),a=fe.createElement("button","adbmsgEngagementPopUpCloseIcon",i),r=this.engagementPopUpModel.header,s=fe.createElement("img","adbmsgEngagementPopUpCloseImg",a),l=A.getJarvisClientRootUrlByEnv(),c="".concat(l,"/assets/collapse.svg");s.src=c,a.addEventListener&&a.addEventListener("click",function(e){n.handleButtonClick(e,r)})}else fe.createElement("div","adbmsgEngagementPopUpLogoImg",e)}},{key:"renderInnerContent",value:function(e,t){var n=fe.createElement("div","adbmsgEngagementPopUpBody",e);this.renderBody(n,t),this.renderControls(e,t),this.renderFooter(e)}},{key:"renderFooter",value:function(e){var t=this;if(this.engagementPopUpModel.footer.link){var n=fe.createElement("div","adbmsgEngagementPopUpLink",e),o=this.engagementPopUpModel.footer.link,i=fe.createElement("u","adbmsgEngagementPopupAnchor",n);i.innerHTML=o.label,i.addEventListener&&i.addEventListener("click",function(e){t.handleButtonClick(e,o)}),fe.createElement("a","adbmsgEngagementDummy",n)}}},{key:"removeFromDom",value:function(){this.adbmsgEngagementPopUpContent&&this.adbmsgEngagementPopUpContent.parentNode.removeChild(this.adbmsgEngagementPopUpContent)}},{key:"recreateDom",value:function(e,t){this.removeFromDom(),this.addToDom(e,t)}}],t&&we(e.prototype,t),n&&we(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();const Ie=new Ae;function Te(e){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te(e)}function Ue(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Oe(o.key),o)}}function ke(e,t,n){return t&&Ue(e.prototype,t),n&&Ue(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Me(e,t,n){return(t=Oe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oe(e){var t=function(e,t){if("object"!=Te(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Te(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Te(t)?t:t+""}const _e=new(ke(function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Me(this,"addEngagementPopUpToDOM",function(e,n,o,i){if(n){"jarvis"===n.theme?t.adbmsgEngagementPopUpContainer=fe.createElement("div","adbmsgEngagementPopUpContainer,adbmsgEngagementPopUpContainerJarvisTheme,outwardAnimate",null):t.adbmsgEngagementPopUpContainer=fe.createElement("div","adbmsgEngagementPopUpContainer,adbmsgEngagementPopUpContainerBackground,outwardAnimate",t.adbmsgEngagementPopUpContainer),o?i.insertBefore(t.adbmsgEngagementPopUpContainer,o):i.appendChild(t.adbmsgEngagementPopUpContainer);var a=e.uiPolicy.yOffset;!isNaN(a)&&a>0?t.adbmsgEngagementPopUpContainer.style.bottom=a+60+52+"px":t.adbmsgEngagementPopUpContainer.style.bottom="152px",Ie.addPopUpToDOM(n,t.adbmsgEngagementPopUpContainer)}}),Me(this,"showPopUp",function(){t.adbmsgEngagementPopUpContainer&&!zn.isAdobeMessagingClientLoadStarted&&(window.innerWidth<=414?t.adbmsgEngagementPopUpContainerHiddenForMobileWidth=!0:t.adbmsgEngagementPopUpContainer.style.display="block")}),Me(this,"hideEngagementPopUp",function(){t.adbmsgEngagementPopUpContainer&&(t.adbmsgEngagementPopUpContainer.style.display="none"),t.adbmsgEngagementPopUpContainerHiddenForMobileWidth=!1}),Me(this,"removeEngagementPopUp",function(){t.adbmsgEngagementPopUpContainer&&(t.adbmsgEngagementPopUpContainer.parentNode.removeChild(t.adbmsgEngagementPopUpContainer),t.adbmsgEngagementPopUpContainer=void 0)}),Me(this,"handleResizeDimension",function(){window.innerWidth<=414?t.adbmsgEngagementPopUpContainer&&!A.isHidden(t.adbmsgEngagementPopUpContainer)&&(t.hideEngagementPopUp(),t.adbmsgEngagementPopUpContainerHiddenForMobileWidth=!0):t.adbmsgEngagementPopUpContainerHiddenForMobileWidth&&(t.showPopUp(),t.adbmsgEngagementPopUpContainerHiddenForMobileWidth=!1)}),Me(this,"setCookieByServerForPopUpClicked",function(e){var t=M.createXMLHttp();t.open("post",zn.initConfig.serverUrl+m.SET_POPUP_COOKIE_PATH,!0),t.setRequestHeader("Content-Type","application/json"),zn.initJson.accessToken&&""!==zn.initJson.accessToken.trim()&&t.setRequestHeader("Authorization",zn.initJson.accessToken),t.setRequestHeader("x-api-key",zn.initJson.clientId),t.withCredentials=!0,t.timeout=3e4,t.onload=function(){t.status>=200&&t.status<400?v.info("The call to server to set the cookie for pop up option selected succeeded"):v.info("The call to server to set the cookie for pop up option selected failed")},t.onerror=function(){v.info("The call to server to set the cookie for pop up option selected failed")},t.ontimeout=function(){v.info("The call to server to set the cookie for pop up option selected timed out")},t.send(e)}),this.adbmsgEngagementPopUpContainer=void 0,this.adbmsgEngagementPopUpContainerHiddenForMobileWidth=!1}));function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function Re(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,je(o.key),o)}}function De(e,t,n){return(t=je(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(e){var t=function(e,t){if("object"!=Le(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Le(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Le(t)?t:t+""}const Ne=new(function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),De(this,"init",function(e){e&&e.localizedData&&(t.localizedData=e.localizedData)}),De(this,"handleGetStartedDXSalesPopUp",function(e){e.preventDefault(),e.stopPropagation(),Fe.hideSalesPopUp(),Xt.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"auto",sourceText:"button"}),Q.sendEvent({"event.workflow":t.getEventWorkflow(),"event.subcategory":"launch","event.type":"click","event.subtype":"get-started","content.name":"button-button","content.mimetype":t.getContentMimeType()}),_e.setCookieByServerForPopUpClicked(JSON.stringify({engagementPopUpId:"DXSales"}))}),De(this,"handleNotNowDXSalesPopUp",function(){Q.sendEvent({"event.workflow":t.getEventWorkflow(),"event.subcategory":"launch","event.type":"click","event.subtype":"not-now","content.name":"button-button","content.mimetype":t.getContentMimeType()}),Fe.hideSalesPopUp(),_e.setCookieByServerForPopUpClicked(JSON.stringify({engagementPopUpId:"DXSales"}))}),De(this,"validate",function(){var e=!0;return t.localizedData&&t.localizedData.popUpTitle&&t.localizedData.popUpDescription&&t.localizedData.popUpGetStartedButton&&t.localizedData.popUpNotNowButton||(e=!1),e}),this.localizedData=void 0},(t=[{key:"renderHeader",value:function(e){var t=fe.createElement("div","adbmsgSalesPopUpLogo",e);fe.createElement("div","adbmsgSalesPopUpLogoSvg",t)}},{key:"renderInnerContent",value:function(e){var t=fe.createElement("div","adbmsgSalesPopUpBody",e);this.renderBody(t);var n=fe.createElement("div","adbmsgSalesPopUpControlContainer",e);this.renderControls(n)}},{key:"renderTitleWithCompanyName",value:function(e,t){return e.replace(/\$\{\w+\}/i,t)}},{key:"renderPopUpTitle",value:function(e,t){var n=this.localizedData.companyPopUpTitle;return n&&e?this.renderTitleWithCompanyName(n,t):this.localizedData.popUpTitle}},{key:"renderPopUpDescription",value:function(e){var t=this.localizedData.companyPopUpDescription;return e&&t?t:this.localizedData.popUpDescription}},{key:"renderBody",value:function(e){var t=zn.initJson.context.companyName,n=!!t,o=fe.createElement("div","adbmsgSalesPopUpAvatar",e);fe.createElement("img","adbmsgSalesPopUpAvatarImg",o).src=A.getRandomAvatarUrl();var i=fe.createElement("div","adbmsgSalesPopUpBodyPara",e),a=fe.createElement("div","adbmsgSalesPopUpBodyParaTitle",i),r="".concat(this.renderPopUpTitle(n,t));a.innerHTML=r,fe.createElement("div","adbmsgSalesPopUpBodyParaDescription",i).innerHTML="".concat(this.renderPopUpDescription(n))}},{key:"renderControls",value:function(e){var t=fe.createElement("div","adbmsgSalesPopUpControls",e),n=fe.createElement("button","spectrum-Button,spectrum-Button--quiet,spectrum-Button--overBackground",t),o=fe.createElement("span","spectrum-Button-label",n);fe.addFocusRingHandling(n),o.innerHTML=this.localizedData.popUpNotNowButton,n.setAttribute("aria-label",this.localizedData.popUpNotNowButton),n.addEventListener&&n.addEventListener("click",this.handleNotNowDXSalesPopUp,!1);var i=fe.createElement("button","spectrum-Button,spectrum-Button--overBackground",t),a=fe.createElement("span","spectrum-Button-label",i);fe.addFocusRingHandling(i),a.innerHTML=this.localizedData.popUpGetStartedButton,i.setAttribute("aria-label",this.localizedData.popUpGetStartedButton),i.addEventListener&&i.addEventListener("click",this.handleGetStartedDXSalesPopUp,!1)}},{key:"addToDom",value:function(e){this.adbmsgSalesPopUpContent=fe.createElement("div","adbmsgSalesPopUpContent",e);var t=fe.createElement("div","adbmsgSalesPopUpHeader",this.adbmsgSalesPopUpContent);this.renderHeader(t);var n=fe.createElement("div","adbmsgSalesPopUpInnerContent",this.adbmsgSalesPopUpContent);if(this.renderInnerContent(n),this.localizedData.isPageVisitSalesPopUpEligible){var o={"event.workflow":"PageVisitSalesPopUp","event.type":"render","env.fw.name":"page_visit_sales-popup","content.mimetype":"page_visit_sales-popup","env.com.version":A.getClientVersion()};Q.sendEvent(o)}}},{key:"removeFromDom",value:function(){this.adbmsgSalesPopUpContent&&this.adbmsgSalesPopUpContent.parentNode.removeChild(this.adbmsgSalesPopUpContent)}},{key:"recreateDom",value:function(e){this.removeFromDom(),this.addToDom(e)}},{key:"getContentMimeType",value:function(){return this.localizedData.isPageVisitSalesPopUpEligible?"page_visit_sales-popup":"DXSalesPopUp"}},{key:"getEventWorkflow",value:function(){return this.localizedData.isPageVisitSalesPopUpEligible?"PageVisitSalesPopUp":"init"}}])&&Re(e.prototype,t),n&&Re(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}function Be(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Je(o.key),o)}}function We(e,t,n){return t&&Be(e.prototype,t),n&&Be(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function He(e,t,n){return(t=Je(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Je(e){var t=function(e,t){if("object"!=xe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=xe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xe(t)?t:t+""}const Fe=new(We(function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),He(this,"addSalesPopUpToDOM",function(e,n,o){if(Ne.init(e),Ne.validate()){t.adbmsgSalesPopUpContainer=document.createElement("div"),t.adbmsgSalesPopUpContainer.classList.add("adbmsgSalesPopUpContainer"),n?o.insertBefore(t.adbmsgSalesPopUpContainer,n):o.appendChild(t.adbmsgSalesPopUpContainer);var i=e.uiPolicy.yOffset;!isNaN(i)&&i>0?t.adbmsgSalesPopUpContainer.style.bottom=i+60+52+"px":t.adbmsgSalesPopUpContainer.style.bottom="152px",Ne.addToDom(t.adbmsgSalesPopUpContainer)}}),He(this,"handleShowPopUp",function(){var e=l.sendMessageToHost(l.hostCallbacks.GET_CONTEXT_CALLBACK);e&&e.companyName&&(zn.updateInitContext(e),Ne.recreateDom(t.adbmsgSalesPopUpContainer))}),He(this,"showSalesPopUp",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ne.validate()?t.adbmsgSalesPopUpContainer&&!zn.isAdobeMessagingClientLoadStarted&&(e&&t.handleShowPopUp(),window.innerWidth<=414?t.adbmsgSalesPopUpContainerHiddenForMobileWidth=!0:(t.sentPopUpRenderAnalytics||(t.sentPopUpRenderAnalytics=!0,Q.sendEvent({"event.workflow":"init","event.subcategory":"launch","event.type":"render","event.subtype":"pop-up","content.name":"button"})),t.adbmsgSalesPopUpContainer.style.display="block")):v.log("Pop up validation failed, not showing pop up.")}),He(this,"hideSalesPopUp",function(){t.adbmsgSalesPopUpContainer&&(t.adbmsgSalesPopUpContainer.style.display="none"),t.adbmsgSalesPopUpContainerHiddenForMobileWidth=!1}),He(this,"removeSalesPopUp",function(){t.adbmsgSalesPopUpContainer&&(t.adbmsgSalesPopUpContainer.parentNode.removeChild(t.adbmsgSalesPopUpContainer),t.adbmsgSalesPopUpContainer=void 0)}),He(this,"handleResizeDimension",function(){window.innerWidth<=414?t.adbmsgSalesPopUpContainer&&!A.isHidden(t.adbmsgSalesPopUpContainer)&&(t.hideSalesPopUp(),t.adbmsgSalesPopUpContainerHiddenForMobileWidth=!0):t.adbmsgSalesPopUpContainerHiddenForMobileWidth&&(t.showSalesPopUp(),t.adbmsgSalesPopUpContainerHiddenForMobileWidth=!1)}),this.adbmsgSalesPopUpContainer=void 0,this.adbmsgSalesPopUpContainerHiddenForMobileWidth=!1,this.sentPopUpRenderAnalytics=!1}));function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function ze(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Ke(o.key),o)}}function Ve(e,t,n){return(t=Ke(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ke(e){var t=function(e,t){if("object"!=Ge(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Ge(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ge(t)?t:t+""}var Xe=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ve(this,"addCampaignAnalyticsToEvent",function(e,t){t&&(t.variationId&&(e["exp.variation_id"]=t.variationId),t.actionBlockId&&(e["exp.action_block_id"]=t.actionBlockId),t.campaignId&&(e["exp.campaign_id"]=t.campaignId),t.responseGUID&&(e["exp.response_guid"]=t.responseGUID),t.surfaceId&&(e["exp.surface_id"]=t.surfaceId),t.containerId&&(e["exp.container_id"]=t.containerId),t.controlGroupId&&(e["exp.control_group_id"]=t.controlGroupId),t.treatmentId&&(e["exp.treatment_id"]=t.treatmentId))}),Ve(this,"handleButtonClick",function(e,n){e.preventDefault(),e.stopPropagation();var o={"event.workflow":"TutorialPopUp","event.type":"click","event.subtype":n.key,"content.name":t.tutorialPopUpModel.analyticsInfo.analyticsId,"content.status":t.tutorialPopUpModel.analyticsInfo.otherInfo};if(t.addCampaignAnalyticsToEvent(o,t.tutorialPopUpModel.analyticsInfo.campaignAnalyticsData),Q.sendEvent(o),"closePopUp"===n.action){tt.hideTutorialPopUp(),Xt.renderCTAasPerPolicy();var i={userId:t.tutorialPopUpModel.analyticsInfo.userId,type:"tutorial"};Ce.minimizePopupClicked(JSON.stringify(i))}else if("openURL"===n.action){var a="".concat(n.url,"#sa_src=web-messaging");ue.openLinkDirectly(a,"_blank")}else"openChat"===n.action&&(tt.hideTutorialPopUp(),Xt.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"TutorialPopUp",sourceText:"button"}))}),Ve(this,"renderBody",function(e){var n=fe.createElement("div","adbmsgTutorialPopUpBodyPara",e);fe.createElement("div","adbmsgTutorialPopUpBodyParaTitle",n).innerHTML=t.tutorialPopUpModel.content,t.tutorialPopUpModel.body&&(fe.createElement("div","adbmsgTutorialPopUpBodyParaDescription",n).innerHTML=t.tutorialPopUpModel.body)}),Ve(this,"renderControls",function(e){for(var n=fe.createElement("div","adbmsgTutorialPopUpControls,spectrum-ButtonGroup",e),o=function(){var e=t.tutorialPopUpModel.footer.buttons[i],o=null;o="primary"===e.variant?fe.createElement("button","spectrum-Button,spectrum-Button--primary,spectrum-ButtonGroup-item,adbmsgTutorial-button",n):fe.createElement("button","spectrum-Button,spectrum-Button--secondary,spectrum-Button--quiet,spectrum-ButtonGroup-item,adbmsgTutorial-button",n);var a=fe.createElement("span","spectrum-Button-label",o);fe.addFocusRingHandling(o),a.innerHTML=e.label,o.setAttribute("aria-label",e.label),o.addEventListener&&o.addEventListener("click",function(n){t.handleButtonClick(n,e)})},i=0;i<t.tutorialPopUpModel.footer.buttons.length;i++)o()}),Ve(this,"renderLink",function(e){if(t.tutorialPopUpModel.footer.link){var n=fe.createElement("div","adbmsgTutorialPopUpLink",e),o=t.tutorialPopUpModel.footer.link,i=fe.createElement("u","adbmsgTutorialPopupAnchor",n);i.innerHTML=o.label,i.addEventListener&&i.addEventListener("click",function(e){t.handleButtonClick(e,o)}),fe.createElement("a","adbmsgTutorialDummy",n)}}),Ve(this,"addPopUpToDOM",function(e,n){t.tutorialPopUpModel=e,t.adbmsgTutorialPopUpContent=fe.createElement("div","adbmsgTutorialPopUpContent",n),t.renderHeader(t.adbmsgTutorialPopUpContent);var o=fe.createElement("div","adbmsgTutorialPopUpInnerContent",t.adbmsgTutorialPopUpContent);if(t.renderInnerContent(o),t.tutorialPopUpModel.isTutorialPopupEnabled||t.tutorialPopUpModel.isTutorialPopupEligible){var i={"event.workflow":"TutorialPopUp","event.type":"render","content.name":t.tutorialPopUpModel.analyticsInfo.analyticsId,"content.status":t.tutorialPopUpModel.analyticsInfo.otherInfo,"env.fw.name":"tutorial-popup"};if(t.tutorialPopUpModel.isTutorialPopupEnabled){i["content.mimetype"]="tutorial-popup";var a={"event.workflow":"TutorialPopUp","event.type":"render","content.name":t.tutorialPopUpModel.analyticsInfo.analyticsId,"content.status":t.tutorialPopUpModel.analyticsInfo.otherInfo,"env.fw.name":"tutorial-popup-gethelp"};t.tutorialPopUpModel.isTutorialPopupGethelpEnabled?a["content.mimetype"]="tutorial-popup-gethelp":a["content.mimetype"]="tutorial-popup-gethelp_control",a["env.com.version"]=A.getClientVersion(),t.addCampaignAnalyticsToEvent(a,t.tutorialPopUpModel.analyticsInfo.campaignAnalyticsData),Q.sendEvent(a)}else i["content.mimetype"]="tutorial-popup_control";i["env.com.version"]=A.getClientVersion(),t.addCampaignAnalyticsToEvent(i,t.tutorialPopUpModel.analyticsInfo.campaignAnalyticsData),Q.sendEvent(i)}}),this.tutorialPopUpModel=null},t=[{key:"renderHeader",value:function(e){var t=this,n=fe.createElement("div","adbmsgTutorialHeader",e),o=(fe.createElement("div","adbmsgTutorialPopUpLogoImg",n),fe.createElement("div","adbmsgTutorialPopUpCloseDiv",n)),i=fe.createElement("button","adbmsgTutorialPopUpCloseIcon",o),a=this.tutorialPopUpModel.header,r=fe.createElement("img","adbmsgTutorialPopUpCloseImg",i),s=A.getJarvisClientRootUrlByEnv(),l="".concat(s,"/assets/collapse.svg");r.src=l,i.addEventListener&&i.addEventListener("click",function(e){t.handleButtonClick(e,a)})}},{key:"renderInnerContent",value:function(e){var t=fe.createElement("div","adbmsgTutorialPopUpBody",e);this.renderBody(t),this.renderControls(e),this.renderLink(e)}},{key:"removeFromDom",value:function(){this.adbmsgTutorialPopUpContent&&this.adbmsgTutorialPopUpContent.parentNode.removeChild(this.adbmsgTutorialPopUpContent)}},{key:"recreateDom",value:function(e,t){this.removeFromDom(),this.addToDom(e,t)}}],t&&ze(e.prototype,t),n&&ze(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();const qe=new Xe;function Ze(e){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(e)}function $e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,et(o.key),o)}}function Ye(e,t,n){return t&&$e(e.prototype,t),n&&$e(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qe(e,t,n){return(t=et(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function et(e){var t=function(e,t){if("object"!=Ze(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Ze(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ze(t)?t:t+""}const tt=new(Ye(function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Qe(this,"addTutorialPopUpToDOM",function(e,n,o,i){n&&(t.adbmsgTutorialPopUpContainer=fe.createElement("div","adbmsgTutorialPopUpContainer,outwardAnimate",null),o?i.insertBefore(t.adbmsgTutorialPopUpContainer,o):i.appendChild(t.adbmsgTutorialPopUpContainer),qe.addPopUpToDOM(n,t.adbmsgTutorialPopUpContainer))}),Qe(this,"showPopUp",function(){t.adbmsgTutorialPopUpContainer&&!zn.isAdobeMessagingClientLoadStarted&&(window.innerWidth<=414?t.adbmsgTutorialPopUpContainerHiddenForMobileWidth=!0:t.adbmsgTutorialPopUpContainer.style.display="block")}),Qe(this,"hideTutorialPopUp",function(){t.adbmsgTutorialPopUpContainer&&(t.adbmsgTutorialPopUpContainer.style.display="none"),t.adbmsgTutorialPopUpContainerHiddenForMobileWidth=!1}),Qe(this,"removeTutorialPopUp",function(){t.adbmsgTutorialPopUpContainer&&(t.adbmsgTutorialPopUpContainer.parentNode.removeChild(t.adbmsgTutorialPopUpContainer),t.adbmsgTutorialPopUpContainer=void 0)}),Qe(this,"handleResizeDimension",function(){window.innerWidth<=414?t.adbmsgTutorialPopUpContainer&&!A.isHidden(t.adbmsgTutorialPopUpContainer)&&(t.hideTutorialPopUp(),t.adbmsgTutorialPopUpContainerHiddenForMobileWidth=!0):t.adbmsgTutorialPopUpContainerHiddenForMobileWidth&&(t.showPopUp(),t.adbmsgTutorialPopUpContainerHiddenForMobileWidth=!1)}),this.adbmsgTutorialPopUpContainer=void 0,this.adbmsgTutorialPopUpContainerHiddenForMobileWidth=!1}));function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function ot(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,at(o.key),o)}}function it(e,t,n){return(t=at(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function at(e){var t=function(e,t){if("object"!=nt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=nt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nt(t)?t:t+""}const rt=new(function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),it(this,"addCampaignAnalyticsToEvent",function(e,t){t&&(t.variationId&&(e["exp.variation_id"]=t.variationId),t.actionBlockId&&(e["exp.action_block_id"]=t.actionBlockId),t.campaignId&&(e["exp.campaign_id"]=t.campaignId),t.responseGUID&&(e["exp.response_guid"]=t.responseGUID),t.surfaceId&&(e["exp.surface_id"]=t.surfaceId),t.containerId&&(e["exp.container_id"]=t.containerId),t.controlGroupId&&(e["exp.control_group_id"]=t.controlGroupId),t.treatmentId&&(e["exp.treatment_id"]=t.treatmentId))}),it(this,"handleButtonClick",function(e,n){e.preventDefault(),e.stopPropagation();var o={"event.workflow":t.getEventWorkflow(),"event.type":"click","event.subtype":n.key,"content.name":t.authoredBotPopupModel.analyticsInfo.analyticsId,"content.status":t.authoredBotPopupModel.analyticsInfo.otherInfo,"env.fw.name":t.getEnvFwName(),"content.mimetype":t.getContentMimeType()};if(t.addCampaignAnalyticsToEvent(o,t.authoredBotPopupModel.analyticsInfo.campaignAnalyticsData),Q.sendEvent(o),"closePopUp"===n.action)dt.hidePopUp(),Xt.renderCTAasPerPolicy();else if("openURL"===n.action){var i="".concat(n.url,"#sa_src=web-messaging");ue.openLinkDirectly(i,"_blank")}else"openChat"===n.action&&(dt.hidePopUp(),Xt.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"AuthoredBotPopUp",sourceText:"button"}))}),it(this,"renderBody",function(e){var n=fe.createElement("div","adbmsgAuthoredBotPopUpBodyPara",e);fe.createElement("div","adbmsgAuthoredBotPopUpBodyParaTitle",n).innerHTML=t.authoredBotPopupModel.content,t.authoredBotPopupModel.body&&(fe.createElement("div","adbmsgAuthoredBotPopUpBodyParaDescription",n).innerHTML=t.authoredBotPopupModel.body)}),it(this,"renderLink",function(e){if(t.authoredBotPopupModel.footer.link){var n=fe.createElement("div","adbmsgAuthoredBotPopUpLink",e),o=t.authoredBotPopupModel.footer.link,i=fe.createElement("u","adbmsgAuthoredBotPopupAnchor",n);i.innerHTML=o.label,i.addEventListener&&i.addEventListener("click",function(e){t.handleButtonClick(e,o)}),fe.createElement("a","adbmsgAuthoredBotDummy",n)}}),it(this,"addPopUpToDOM",function(e,n){t.authoredBotPopupModel=e,t.adbmsgAuthoredBotPopUpContent=fe.createElement("div","adbmsgAuthoredBotPopUpContent",n);var o=fe.createElement("div","adbmsgAuthoredBotPopUpInnerContent",t.adbmsgAuthoredBotPopUpContent);t.renderInnerContent(o),t.renderHeader(t.adbmsgAuthoredBotPopUpContent)}),it(this,"showPopUp",function(e){if(e){e.style.display="block";var n={"event.workflow":t.getEventWorkflow(),"event.type":"render","content.name":t.authoredBotPopupModel.analyticsInfo.analyticsId};n["env.fw.name"]=t.getEnvFwName(),n["content.mimetype"]=t.getContentMimeType(),n["env.com.version"]=A.getClientVersion(),t.addCampaignAnalyticsToEvent(n,t.authoredBotPopupModel.analyticsInfo.campaignAnalyticsData),t.authoredBotPopupModel.controls.playAudio?new Audio(A.getPopupNotification()).play().then(function(){n["content.status"]="audio-played",Q.sendEvent(n)}).catch(function(){n["content.status"]="audio-failed",Q.sendEvent(n)}):Q.sendEvent(n)}}),it(this,"playAudio",function(){t.authoredBotPopupModel.controls.playAudio&&new Audio(A.getPopupNotification()).play()}),this.authoredBotPopupModel=null},t=[{key:"renderHeader",value:function(e){var t=this,n=fe.createElement("div","adbmsgAuthoredBotHeader",e),o=fe.createElement("div","adbmsgAuthoredBotPopUpCloseDiv",n),i=fe.createElement("button","adbmsgAuthoredBotPopUpCloseIcon",o),a=this.authoredBotPopupModel.header.buttonLabel;i.setAttribute("aria-label",a);var r=this.authoredBotPopupModel.header;fe.createElement("div","adbmsgAuthoredBotPopUpCloseImg",i),i.addEventListener&&i.addEventListener("click",function(e){t.handleButtonClick(e,r)})}},{key:"renderInnerContent",value:function(e){var t=this,n=fe.createElement("div","adbmsgAuthoredBotPopUpBody",e);if(this.renderBody(n),this.renderLink(e),n.addEventListener){var o={action:"openChat"};n.addEventListener("click",function(e){t.handleButtonClick(e,o)})}}},{key:"removeFromDom",value:function(){this.adbmsgAuthoredBotPopUpContent&&this.adbmsgAuthoredBotPopUpContent.parentNode.removeChild(this.adbmsgAuthoredBotPopUpContent)}},{key:"getEventWorkflow",value:function(){return this.authoredBotPopupModel.isPageVisitSalesPopUpEnabled?"PageVisitSalesPopUp":"AuthoredBotPopUp"}},{key:"getEnvFwName",value:function(){return this.authoredBotPopupModel.isPageVisitSalesPopUpEnabled?"page_visit_sales-popup":"authoredbot-popup"}},{key:"getContentMimeType",value:function(){return this.authoredBotPopupModel.isPageVisitSalesPopUpEnabled?"page_visit_sales-popup_control":this.authoredBotPopupModel.analyticsInfo.botName}}],t&&ot(e.prototype,t),n&&ot(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());function st(e){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},st(e)}function lt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ut(o.key),o)}}function ct(e,t,n){return t&&lt(e.prototype,t),n&&lt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function pt(e,t,n){return(t=ut(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ut(e){var t=function(e,t){if("object"!=st(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=st(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==st(t)?t:t+""}const dt=new(ct(function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),pt(this,"addPopUpToDOM",function(e,n,o,i){if(n){t.adbmsgAuthoredBotPopUpContainer=fe.createElement("div","adbmsgAuthoredBotPopUpContainer,outwardAnimate",null);var a=e.uiPolicy.yOffset;!isNaN(a)&&a>0?t.adbmsgAuthoredBotPopUpContainer.style.bottom=a+1+"px":t.adbmsgAuthoredBotPopUpContainer.style.bottom="41px",o?i.insertBefore(t.adbmsgAuthoredBotPopUpContainer,o):i.appendChild(t.adbmsgAuthoredBotPopUpContainer),rt.addPopUpToDOM(n,t.adbmsgAuthoredBotPopUpContainer)}}),pt(this,"showPopUp",function(){rt.showPopUp(t.adbmsgAuthoredBotPopUpContainer)}),pt(this,"hidePopUp",function(){t.adbmsgAuthoredBotPopUpContainer&&(t.adbmsgAuthoredBotPopUpContainer.style.display="none"),t.adbmsgAuthoredBotPopUpContainerHiddenForMobileWidth=!1}),pt(this,"removePopUp",function(){t.adbmsgAuthoredBotPopUpContainer&&(t.adbmsgAuthoredBotPopUpContainer.parentNode.removeChild(t.adbmsgAuthoredBotPopUpContainer),t.adbmsgAuthoredBotPopUpContainer=void 0)}),pt(this,"handleResizeDimension",function(){window.innerWidth<=414?t.adbmsgAuthoredBotPopUpContainer&&!A.isHidden(t.adbmsgAuthoredBotPopUpContainer)&&(t.hidePopUp(),t.adbmsgAuthoredBotPopUpContainerHiddenForMobileWidth=!0):t.adbmsgAuthoredBotPopUpContainerHiddenForMobileWidth&&(t.showPopUp(),t.adbmsgAuthoredBotPopUpContainerHiddenForMobileWidth=!1)}),this.adbmsgAuthoredBotPopUpContainer=void 0,this.adbmsgAuthoredBotPopUpContainerHiddenForMobileWidth=!1}));function mt(e){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(e)}function gt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,bt(o.key),o)}}function ft(e,t,n){return(t=bt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e){var t=function(e,t){if("object"!=mt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=mt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mt(t)?t:t+""}var vt=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ft(this,"handleButtonClick",function(e,n){e.preventDefault(),e.stopPropagation();var o={"event.workflow":"AutoRenewalPopUp","event.type":"click","event.subtype":n.key,"content.name":t.autoRenewalPopupModel.analyticsInfo.analyticsId,"content.status":t.autoRenewalPopupModel.analyticsInfo.otherInfo};if(Q.sendEvent(o),n)if("closePopUp"===n.action){St.hidePopUp(),Xt.renderCTAasPerPolicy();var i={userId:t.autoRenewalPopupModel.analyticsInfo.userId,type:"autoRenewal"};Ce.minimizePopupClicked(JSON.stringify(i))}else if("openURL"===n.action){var a="".concat(n.url,"#sa_src=web-messaging");ue.openLinkDirectly(a,"_blank")}else"openChat"===n.action&&(St.hidePopUp(),Xt.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"AutoRenewalPopUp",sourceText:"button",customGreet:n.customGreet}))}),ft(this,"renderBody",function(e){var n=fe.createElement("div","adbmsgAutoRenewalPopUpBodyPara",e);(/\d/.test(t.autoRenewalPopupModel.content)?fe.createElement("div","adbmsgAutoRenewalPopUpBodyParaTitleNumber",n):fe.createElement("div","adbmsgAutoRenewalPopUpBodyParaTitle",n)).innerHTML=t.autoRenewalPopupModel.content,t.autoRenewalPopupModel.body&&(fe.createElement("div","adbmsgAutoRenewalPopUpBodyParaDescription",n).innerHTML=t.autoRenewalPopupModel.body)}),ft(this,"renderControls",function(e){for(var n=fe.createElement("div","adbmsgAutoRenewalPopUpControls,spectrum-ButtonGroup",e),o=function(){var e=t.autoRenewalPopupModel.footer.buttons[i],o=null;o="primary"===e.variant?fe.createElement("button","spectrum-Button,spectrum-Button--primary,spectrum-ButtonGroup-item,adbmsgAutoRenewal-button",n):fe.createElement("button","spectrum-Button,spectrum-Button--secondary,spectrum-Button--quiet,spectrum-ButtonGroup-item,adbmsgAutoRenewal-button",n);var a=fe.createElement("span","spectrum-Button-label",o);fe.addFocusRingHandling(o),a.innerHTML=e.label,o.setAttribute("aria-label",e.label),o.addEventListener&&o.addEventListener("click",function(n){t.handleButtonClick(n,e)})},i=0;i<t.autoRenewalPopupModel.footer.buttons.length;i++)o()}),ft(this,"addPopUpToDOM",function(e,n){t.autoRenewalPopupModel=e,t.adbmsgAutoRenewalPopUpContent=fe.createElement("div","adbmsgAutoRenewalPopUpContent",n),t.renderHeader(t.adbmsgAutoRenewalPopUpContent);var o=fe.createElement("div","adbmsgAutoRenewalPopUpInnerContent",t.adbmsgAutoRenewalPopUpContent);t.renderInnerContent(o)}),ft(this,"showPopUp",function(e){if(e){e.style.display="block";var n={"event.workflow":"AutoRenewalPopUp","event.type":"render","content.name":t.autoRenewalPopupModel.analyticsInfo.analyticsId,"env.fw.name":"autoRenewal-popup"};n["content.mimetype"]=t.autoRenewalPopupModel.analyticsInfo.botName,n["env.com.version"]=A.getClientVersion(),Q.sendEvent(n)}}),this.autoRenewalPopupModel=null},t=[{key:"renderHeader",value:function(e){var t=this;if(this.autoRenewalPopupModel){var n=fe.createElement("div","adbmsgAutoRenewalHeader",e),o=fe.createElement("div","adbmsgAutoRenewalPopUpCloseDiv",n),i=fe.createElement("button","adbmsgAutoRenewalPopUpCloseIcon",o),a=this.autoRenewalPopupModel.header,r=fe.createElement("img","adbmsgTutorialPopUpCloseImg",i),s=A.getJarvisClientRootUrlByEnv(),l="".concat(s,"/assets/collapse.svg");r.src=l,i.addEventListener&&i.addEventListener("click",function(e){t.handleButtonClick(e,a)})}}},{key:"renderInnerContent",value:function(e){var t=fe.createElement("div","adbmsgAutoRenewalPopUpBody",e);this.renderBody(t),this.renderControls(e)}},{key:"removeFromDom",value:function(){this.adbmsgAutoRenewalPopUpContent&&this.adbmsgAutoRenewalPopUpContent.parentNode.removeChild(this.adbmsgAutoRenewalPopUpContent)}}],t&&gt(e.prototype,t),n&&gt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();const yt=new vt;function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function Ct(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Et(o.key),o)}}function Pt(e,t,n){return t&&Ct(e.prototype,t),n&&Ct(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function wt(e,t,n){return(t=Et(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Et(e){var t=function(e,t){if("object"!=ht(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=ht(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ht(t)?t:t+""}const St=new(Pt(function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),wt(this,"addPopUpToDOM",function(e,n,o,i){if(n){t.adbmsgAutoRenewalPopUpContainer=fe.createElement("div","adbmsgAutoRenewalPopUpContainer,outwardAnimate",null);var a=e.uiPolicy.yOffset;!isNaN(a)&&a>0?t.adbmsgAutoRenewalPopUpContainer.style.bottom=a+1+"px":t.adbmsgAutoRenewalPopUpContainer.style.bottom="41px",o?i.insertBefore(t.adbmsgAutoRenewalPopUpContainer,o):i.appendChild(t.adbmsgAutoRenewalPopUpContainer),yt.addPopUpToDOM(n,t.adbmsgAutoRenewalPopUpContainer)}}),wt(this,"showPopUp",function(){yt.showPopUp(t.adbmsgAutoRenewalPopUpContainer)}),wt(this,"hidePopUp",function(){t.adbmsgAutoRenewalPopUpContainer&&(t.adbmsgAutoRenewalPopUpContainer.style.display="none"),t.adbmsgAutoRenewalPopUpContainerHiddenForMobileWidth=!1}),wt(this,"removePopUp",function(){t.adbmsgAutoRenewalPopUpContainer&&(t.adbmsgAutoRenewalPopUpContainer.parentNode.removeChild(t.adbmsgAutoRenewalPopUpContainer),t.adbmsgAutoRenewalPopUpContainer=void 0)}),wt(this,"handleResizeDimension",function(){window.innerWidth<=414?t.adbmsgAutoRenewalPopUpContainer&&!A.isHidden(t.adbmsgAutoRenewalPopUpContainer)&&(t.hidePopUp(),t.adbmsgAutoRenewalPopUpContainerHiddenForMobileWidth=!0):t.adbmsgAutoRenewalPopUpContainerHiddenForMobileWidth&&(t.showPopUp(),t.adbmsgAutoRenewalPopUpContainerHiddenForMobileWidth=!1)}),this.adbmsgAutoRenewalPopUpContainer=void 0,this.adbmsgAutoRenewalPopUpContainerHiddenForMobileWidth=!1}));function At(e){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(e)}function It(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Ut(o.key),o)}}function Tt(e,t,n){return(t=Ut(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ut(e){var t=function(e,t){if("object"!=At(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=At(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==At(t)?t:t+""}const kt=new(function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Tt(this,"handleCTAClick",function(e){if(e.preventDefault(),e.stopPropagation(),t.userInteracted=!0,t.popupData.button1ClickAnalytics){var n,o,i,a,r={"event.workflow":t.popupData.identifier,"event.type":"click","event.subtype":t.popupData.button1ClickAnalytics,"event.user_guid":null===(n=zn.userProfile)||void 0===n?void 0:n.userGuid,"event.visitor_guid":t.ecid,"exp.campaign_id":null===(o=Bt.campaignInformation)||void 0===o?void 0:o.campaignId,"exp.surface_id":null===(i=Bt.campaignInformation)||void 0===i?void 0:i.surfaceId,"exp.treatment_id":null===(a=Bt.campaignInformation)||void 0===a?void 0:a.treatmentId};v.log("eventObj",r),Q.sendEvent(r)}var s,l=t.popupData.button1Command;"launch"===l?Xt.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"aepInvitationPopUp",sourceText:"button"}):(v.error("AEPInvitationPopUp: Invalid command - ",l),D.error("AEPInvitationPopUp: Invalid command received for appid: ",zn.initJson.appid," command: ",l," popupIdentifier: ",null===(s=t.popupData)||void 0===s?void 0:s.identifier))}),Tt(this,"handleCloseClick",function(e){var n,o;if(e.preventDefault(),e.stopPropagation(),t.userInteracted=!0,t.popupData.crossClickAnalytics){var i,a,r,s,l={"event.workflow":t.popupData.identifier,"event.type":"close","event.subtype":t.popupData.crossClickAnalytics,"event.user_guid":null===(i=zn.userProfile)||void 0===i?void 0:i.userGuid,"event.visitor_guid":t.ecid,"exp.campaign_id":null===(a=Bt.campaignInformation)||void 0===a?void 0:a.campaignId,"exp.surface_id":null===(r=Bt.campaignInformation)||void 0===r?void 0:r.surfaceId,"exp.treatment_id":null===(s=Bt.campaignInformation)||void 0===s?void 0:s.treatmentId};v.log("eventObj",l),Q.sendEvent(l)}Bt.hidePopUp(),(null===(n=zn.serverInitResponse)||void 0===n||null===(n=n.uiPolicy)||void 0===n?void 0:n.showCTA)&&Xt.renderCTAasPerPolicy();var c={userId:(null===(o=zn.userProfile)||void 0===o?void 0:o.userGuid)||t.ecid,popupName:t.popupData.identifier,crossClickMaxLimit:t.popupData.crossClickMaxLimit,renderControlDuration:t.popupData.renderControlDuration,type:"AJOPopUp"};Ce.minimizePopupClicked(JSON.stringify(c))}),Tt(this,"handleBodyClick",function(e){var n;if(e.preventDefault(),e.stopPropagation(),t.userInteracted=!0,t.popupData.bodyClickAnalytics){var o,i,a,r,s={"event.workflow":t.popupData.identifier,"event.type":"click","event.subtype":t.popupData.bodyClickAnalytics,"event.user_guid":null===(o=zn.userProfile)||void 0===o?void 0:o.userGuid,"event.visitor_guid":t.ecid,"exp.campaign_id":null===(i=Bt.campaignInformation)||void 0===i?void 0:i.campaignId,"exp.surface_id":null===(a=Bt.campaignInformation)||void 0===a?void 0:a.surfaceId,"exp.treatment_id":null===(r=Bt.campaignInformation)||void 0===r?void 0:r.treatmentId};v.log("eventObj",s),Q.sendEvent(s)}var l=null===(n=t.popupData)||void 0===n?void 0:n.bodyCommand;if("launch"===l)Xt.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"aepInvitationPopUp",sourceText:"body"});else if(l){var c;v.error("AEPInvitationPopUp: Invalid command - ",l),D.error("AEPInvitationPopUp: Invalid command received for appid: ",zn.initJson.appid," command: ",l," popupIdentifier: ",null===(c=t.popupData)||void 0===c?void 0:c.identifier)}}),this.popupData=null,this.adbmsgPopUpContent=null,this.userInteracted=!1,this.ecid=null},t=[{key:"renderCloseButton",value:function(e){var t=this,n=fe.createElement("button","adbmsgAEPPopUpCloseBtn",e);n.setAttribute("aria-label","Close"),fe.createElement("div","adbmsgAEPPopUpCloseImg",n),n.addEventListener&&n.addEventListener("click",function(e){t.handleCloseClick(e)})}},{key:"renderContent",value:function(e){var t=fe.createElement("div","adbmsgAEPPopUpContent",e);this.popupData.title&&(fe.createElement("div","adbmsgAEPPopUpTitle",t).textContent=this.popupData.title),this.popupData.message&&(fe.createElement("div","adbmsgAEPPopUpMessage",t).textContent=this.popupData.message)}},{key:"renderCTAButton",value:function(e){var t=this;if(this.popupData.button1Label){var n=fe.createElement("button","adbmsgAEPPopUpCTABtn",e);n.textContent=this.popupData.button1Label,n.setAttribute("aria-label",this.popupData.button1Label),n.addEventListener&&n.addEventListener("click",function(e){t.handleCTAClick(e)})}}},{key:"addToDom",value:function(e,t){var n,o,i,a,r=this;this.popupData=e,this.userInteracted=!1,this.ecid=A.getECIDFromAMCVCookie(),this.adbmsgPopUpContent=fe.createElement("div","adbmsgAEPInvitationPopUp",t),e.button1Label||this.adbmsgPopUpContent.classList.add("adbmsgAEPInvitationPopUp--noCta"),this.adbmsgPopUpContent.addEventListener("click",function(e){r.handleBodyClick(e)}),this.renderCloseButton(this.adbmsgPopUpContent),this.renderContent(this.adbmsgPopUpContent),this.renderCTAButton(this.adbmsgPopUpContent);var s={"event.workflow":this.popupData.identifier,"event.type":"render","event.subtype":"aepInvitationPopUp","event.user_guid":null===(n=zn.userProfile)||void 0===n?void 0:n.userGuid,"event.visitor_guid":this.ecid,"exp.campaign_id":null===(o=Bt.campaignInformation)||void 0===o?void 0:o.campaignId,"exp.surface_id":null===(i=Bt.campaignInformation)||void 0===i?void 0:i.surfaceId,"exp.treatment_id":null===(a=Bt.campaignInformation)||void 0===a?void 0:a.treatmentId};v.log("eventObj",s),Q.sendEvent(s)}},{key:"removeFromDom",value:function(){if(this.adbmsgPopUpContent&&!this.userInteracted){var e,t,n,o,i={"event.workflow":this.popupData.identifier,"event.type":"abandon","event.subtype":"aepInvitationPopUp","event.user_guid":null===(e=zn.userProfile)||void 0===e?void 0:e.userGuid,"event.visitor_guid":this.ecid,"exp.campaign_id":null===(t=Bt.campaignInformation)||void 0===t?void 0:t.campaignId,"exp.surface_id":null===(n=Bt.campaignInformation)||void 0===n?void 0:n.surfaceId,"exp.treatment_id":null===(o=Bt.campaignInformation)||void 0===o?void 0:o.treatmentId};Q.sendEvent(i)}this.adbmsgPopUpContent&&(this.adbmsgPopUpContent.parentNode.removeChild(this.adbmsgPopUpContent),this.adbmsgPopUpContent=null)}}],t&&It(e.prototype,t),n&&It(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());function Mt(e){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mt(e)}function Ot(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function a(n,o,i,a){var l=o&&o.prototype instanceof s?o:s,c=Object.create(l.prototype);return _t(c,"_invoke",function(n,o,i){var a,s,l,c=0,p=i||[],u=!1,d={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,s=0,l=e,d.n=n,r}};function m(n,o){for(s=n,l=o,t=0;!u&&c&&!i&&t<p.length;t++){var i,a=p[t],m=d.p,g=a[2];n>3?(i=g===o)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=m&&((i=n<2&&m<a[1])?(s=0,d.v=o,d.n=a[1]):m<g&&(i=n<3||a[0]>o||o>g)&&(a[4]=n,a[5]=o,d.n=g,s=0))}if(i||n>1)return r;throw u=!0,o}return function(i,p,g){if(c>1)throw TypeError("Generator is already running");for(u&&1===p&&m(p,g),s=p,l=g;(t=s<2?e:l)||!u;){a||(s?s<3?(s>1&&(d.n=-1),m(s,l)):d.n=l:d.v=l);try{if(c=2,a){if(s||(i="next"),t=a[i]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),s=1);a=e}else if((t=(u=d.n<0)?l:n.call(o,d))!==r)break}catch(t){a=e,s=1,l=t}finally{c=1}}return{value:t,done:u}}}(n,i,a),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var p=[][o]?t(t([][o]())):(_t(t={},o,function(){return this}),t),u=c.prototype=s.prototype=Object.create(p);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,_t(e,i,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=c,_t(u,"constructor",c),_t(c,"constructor",l),l.displayName="GeneratorFunction",_t(c,i,"GeneratorFunction"),_t(u),_t(u,i,"Generator"),_t(u,o,function(){return this}),_t(u,"toString",function(){return"[object Generator]"}),(Ot=function(){return{w:a,m:d}})()}function _t(e,t,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_t=function(e,t,n,o){function a(t,n){_t(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},_t(e,t,n,o)}function Lt(e,t,n,o,i,a,r){try{var s=e[a](r),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,i)}function Rt(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){var a=e.apply(t,n);function r(e){Lt(a,o,i,r,s,"next",e)}function s(e){Lt(a,o,i,r,s,"throw",e)}r(void 0)})}}function Dt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,xt(o.key),o)}}function jt(e,t,n){return t&&Dt(e.prototype,t),n&&Dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nt(e,t,n){return(t=xt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xt(e){var t=function(e,t){if("object"!=Mt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Mt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Mt(t)?t:t+""}const Bt=new(jt(function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Nt(this,"shouldShowPopup",function(e,t){var n,o=(null===(n=zn.serverInitResponse)||void 0===n?void 0:n.popupStats)||[],i=parseInt(t,10);if(isNaN(i)||i<=0)return v.log("[AEP] No valid crossClickMaxLimit, showing popup"),!0;var a=o.find(function(t){return t.popupname===e}),r=(null==a?void 0:a.count)||0;return v.log('[AEP] Popup "'.concat(e,'" - count: ').concat(r,", maxLimit: ").concat(i)),!(r>=i)||(v.log('[AEP] Popup "'.concat(e,'" exceeded max limit, not showing')),!1)}),Nt(this,"fetchOdinPopupData",function(){var e=Rt(Ot().m(function e(t){var n,o,i,a,r,s;return Ot().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t&&""!==t.trim()){e.n=1;break}return v.warn("[AEP] No odinUrl provided"),e.a(2,null);case 1:return e.p=1,o=t,v.log("[AEP] Fetching popup data from:",o),e.n=2,fetch(o,{method:"GET",headers:{Accept:"application/json"}});case 2:if((i=e.v).ok){e.n=3;break}return v.error("[AEP] Odin request failed:",i.status),e.a(2,null);case 3:return e.n=4,i.json();case 4:if(a=e.v,v.log("[AEP] Odin response:",a),r=null,null!==(n=a.data)&&void 0!==n&&null!==(n=n.aepinvitationpopupByPath)&&void 0!==n&&n.item&&(r=a.data.aepinvitationpopupByPath.item),!r){e.n=5;break}return v.log("[AEP] Extracted popup data:",r),e.a(2,r);case 5:return v.warn("[AEP] Could not extract popup data from response"),e.a(2,null);case 6:return e.p=6,s=e.v,v.error("[AEP] Error fetching Odin data:",s),e.a(2,null)}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()),Nt(this,"initializeWithAEPResult",function(){var e=Rt(Ot().m(function e(n){var o,i,a;return Ot().w(function(e){for(;;)switch(e.n){case 0:if(n&&n.odinUrl){e.n=1;break}return v.log("[AEP] No odinUrl in AEP result, skipping popup"),e.a(2,Promise.reject("No odinUrl provided"));case 1:return t.campaignInformation=n.campaignInformation||"",e.n=2,t.fetchOdinPopupData(n.odinUrl);case 2:if(o=e.v){e.n=3;break}return v.log("[AEP] No popup data received from Odin"),e.a(2,Promise.reject("No popup data from Odin"));case 3:if(i=o.identifier||"",a=o.crossClickMaxLimit||"0",t.shouldShowPopup(i,a)){e.n=4;break}return v.log("[AEP] Popup render limit exceeded, not showing"),e.a(2,Promise.reject("Popup render limit exceeded"));case 4:return zn.aepPopUp=o,e.a(2,Promise.resolve())}},e)}));return function(t){return e.apply(this,arguments)}}()),Nt(this,"addPopUpToDOM",function(e,n,o){var i;t.adbmsgAEPPopUpContainer=fe.createElement("div","adbmsgAEPInvitationPopUpContainer",null);var a=(null===(i=zn.serverInitResponse)||void 0===i||null===(i=i.uiPolicy)||void 0===i?void 0:i.yOffset)||40;t.adbmsgAEPPopUpContainer.style.bottom=a+"px",n?o.insertBefore(t.adbmsgAEPPopUpContainer,n):o.appendChild(t.adbmsgAEPPopUpContainer),kt.addToDom(e,t.adbmsgAEPPopUpContainer)}),Nt(this,"showPopUp",function(){t.adbmsgAEPPopUpContainer&&(t.adbmsgAEPPopUpContainer.style.display="block")}),Nt(this,"hidePopUp",function(){t.adbmsgAEPPopUpContainer&&(t.adbmsgAEPPopUpContainer.style.display="none")}),Nt(this,"removePopUp",function(){var e;t.adbmsgAEPPopUpContainer&&(kt.removeFromDom(),null===(e=t.adbmsgAEPPopUpContainer.parentNode)||void 0===e||e.removeChild(t.adbmsgAEPPopUpContainer),t.adbmsgAEPPopUpContainer=void 0)}),this.adbmsgAEPPopUpContainer=void 0,this.campaignInformation=null}));function Wt(e){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(e)}function Ht(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,r,s=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(s.push(o.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Jt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function Ft(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Vt(o.key),o)}}function Gt(e,t,n){return t&&Ft(e.prototype,t),n&&Ft(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function zt(e,t,n){return(t=Vt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vt(e){var t=function(e,t){if("object"!=Wt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Wt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wt(t)?t:t+""}var Kt=Gt(function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),zt(this,"getMessageUIInitPayload",function(){var e=window.location.origin;return zn.initJson.appType&&"desktop"===zn.initJson.appType.toLowerCase()&&(e="*"),{namespace:"adbmsg",appId:zn.initJson.appid,window_origin:e,iframe_origin:zn.getMessagingUIURL(),popped:zn.getMessagingWindowState()===zn.messagingWindowStateEnum.POPOUT,hostAnalyticsCallbackPresent:!!zn.initJson.callbacks.analyticsCallback,openURLCallbackPresent:!!zn.initJson.callbacks.openURLActionCallback,params:zn.getCommonAnalyticsParams(),context:zn.getContextInfo(),userProfile:zn.userProfile,userConsent:zn.userConsent,defaultUserConsent:zn.serverInitResponse.defaultUserConsent,consentLevels:zn.serverInitResponse.consentLevels,showFullScreenMobile:zn.serverInitResponse.showFullScreenMobile,iframeTitle:zn.serverInitResponse.iframeTitle,aepCampaigns:zn.aepCampaigns}}),zt(this,"getMessagingClientHashedUrl",function(){var e=window.location.origin;e||(e=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),zn.initJson.appType&&"desktop"===zn.initJson.appType.toLowerCase()&&(e="*");var t={window_origin:e,iframe_origin:zn.getMessagingUIURL(zn.mnmMode),popped:zn.getMessagingWindowState()===zn.messagingWindowStateEnum.POPOUT};return zn.getMessagingUIURL(zn.mnmMode)+"?lc="+zn.initJson.language+"_"+zn.initJson.region+"#"+encodeURIComponent(JSON.stringify(t))}),zt(this,"isMobile",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Math.min(window.innerWidth,window.innerHeight),n=navigator.userAgent||navigator.vendor||window.opera;return!!/iPhone|iPod|Android.*Mobile|Windows Phone|BlackBerry|IEMobile|Opera Mini/i.test(n)&&(e?t<=480:t<=768)}),zt(this,"loadIframeUI",function(){t.setAssistantParamsIfNeeded();var e=zn.serverInitResponse;t.adbmsgContentIframe.setAttribute("frameBorder",0),t.adbmsgContentIframe.setAttribute("src",t.getMessagingClientHashedUrl()),e.iframeTitle&&t.adbmsgContentIframe.setAttribute("title",e.iframeTitle)}),zt(this,"setAssistantParamsIfNeeded",function(){zn.serverInitResponse.releaseControl.assistantUiURL&&(t.adbmsgContentContainer.classList.add("assistantUiMinimised"),zn.serverInitResponse.releaseControl.adobeMessagingClientURL=zn.serverInitResponse.releaseControl.assistantUiURL)}),zt(this,"addSpinner",function(){t.waitSpinner=fe.createElement("div","spectrum,spectrum--light",t.adbmsgContentContainer);var e=fe.createElement("div","spectrum-CircleLoader,spectrum-CircleLoader--indeterminate,spectrum-CircleLoader,react-spectrum-Wait--centered,spinnner",fe.createElement("div","wait-wrapper",t.waitSpinner));fe.createElement("div","spectrum-CircleLoader-track",e);var n=fe.createElement("div","spectrum-CircleLoader-fills",e),o=fe.createElement("div","spectrum-CircleLoader-fillMask1",n),i=fe.createElement("div","spectrum-CircleLoader-fillMask2",n),a=fe.createElement("div","spectrum-CircleLoader-fillSubMask1",o),r=fe.createElement("div","spectrum-CircleLoader-fillSubMask2",i);fe.createElement("div","spectrum-CircleLoader-fill",a),fe.createElement("div","spectrum-CircleLoader-fill",r)}),zt(this,"removeSpinner",function(){t.waitSpinner&&(t.waitSpinner.style.display="none",t.waitSpinner.parentNode.removeChild(t.waitSpinner))}),zt(this,"showSpinner",function(){t.waitSpinner&&(t.waitSpinner.style.display="block")}),zt(this,"hideCTA",function(){t.adbmsgCta.style.display="none",t.adbmsgCta.setAttribute("aria-expanded","true")}),zt(this,"showCTA",function(e){t.adbmsgCta.style.display="block",t.adbmsgCta.setAttribute("aria-expanded","false"),e&&""!==e&&t.adbmsgCta.classList.add(e)}),zt(this,"handleOpenMessagingWindow",function(e){var n;if(zn.isAdobeMessagingClientLoadStarted||(n=l.sendMessageToHost(l.hostCallbacks.GET_CONTEXT_CALLBACK))&&("teamAdmin"===n.userRole&&zn.serverInitResponse.agentFallbackLocale&&zn.serverInitResponse.enterpriseTeamLocale&&zn.serverInitResponse.agentFallbackLocale!=zn.serverInitResponse.enterpriseTeamLocale&&(zn.serverInitResponse.agentFallbackLocale=zn.serverInitResponse.enterpriseTeamLocale),zn.updateInitContext(n)),e&&e.sourceType){var o=e.componentid||zn.initJson.componentid,i=(e.componentver||zn.initJson.componentver,e.sourceType),a=e.sourceText||"",r={"event.workflow":"init","event.subcategory":"launch","event.type":"click"};"AdobeMessaging"===o?t.badgeVisible?r["event.subtype"]="unread":r["event.subtype"]="new":o&&(r["event.subtype"]=o.toLowerCase()),i&&a&&(r["content.name"]=(i+"-"+a).toLowerCase()),Q.sendEvent(r)}n||(n={}),e&&e.customGreet&&(n.greetContext=e.customGreet,zn.updateInitContext(n));var s=zn.serverInitResponse;if(s.releaseControl.showAdobeMessaging){if(Fe.removeSalesPopUp(),_e.removeEngagementPopUp(),dt.removePopUp(),St.removePopUp(),Bt.removePopUp(),s.showFullScreenMobile)return zn.isAdobeMessagingClientLoadStarted=!0,t.setAssistantParamsIfNeeded(),void t.handlePopOut();zn.isAdobeMessagingClientLoadStarted?re.getLoadCompleteState()&&(t.hideCTA(),t.adbmsgContentContainer.style.display="block",re.sendMessageToMessagingUI(re.uiMessagesEnum.WINDOW_OPENED),t.badgeVisible&&re.sendMessageToMessagingUI(re.uiMessagesEnum.REFRESH_MESSAGE_UI)):(zn.isAdobeMessagingClientLoadStarted=!0,zn.initJson.lazyLoad?t.loadIframeUI():n?re.sendMessageToMessagingUI(re.uiMessagesEnum.START_SERVICE_CONNECTION,n):re.sendMessageToMessagingUI(re.uiMessagesEnum.START_SERVICE_CONNECTION),t.hideCTA(),t.adbmsgContentContainer.style.display="block"),t.adbmsgContentContainer.classList.remove("downwardAnimate"),t.adbmsgContentContainer.classList.add("upwardAnimate"),zn.initJson&&zn.initJson.messagingWindowInTopLayer&&(t.adbmsgContentContainer.hasAttribute("data-react-aria-top-layer")||t.adbmsgContentContainer.setAttribute("data-react-aria-top-layer","true")),t.showConversationMarker(!1),t.isMobile()&&setTimeout(function(){window.onhashchange=null,location.hash+="#messaging",setTimeout(function(){window.onhashchange=function(){location.hash.includes("#messaging")||t.handleMinimizeMessagingWindow(!1,zn.mnmMode)}},0)},0)}}),zt(this,"handleOpenZeonWindow",function(){t.hideCTA(),t.adbmsgContentContainerMnm.style.display="block",re.sendMessageToZeon(re.uiMessagesEnum.WINDOW_OPENED),t.adbmsgContentContainerMnm.classList.remove("downwardAnimate"),t.adbmsgContentContainerMnm.classList.add("upwardAnimate"),t.showConversationMarker(!1)}),zt(this,"handleWSCreationForClientWindow",function(){v.log("Creating WS for host window"),D.info("Going to create session because of new session created in pop out for appid: ",zn.initJson.appid," and client id: ",zn.initJson.clientId),re.sendMessageToMessagingUI(re.uiMessagesEnum.START_SERVICE_CONNECTION,null,!1)}),zt(this,"handleExpandWindow",function(e){"EXPAND"===e?t.adbmsgContentContainer.classList.add("adbmsgContentContainerMaximised"):t.adbmsgContentContainer.classList.remove("adbmsgContentContainerMaximised"),re.sendMessageToMessagingUI(re.uiMessagesEnum.REFRESH_MESSAGE_UI)}),zt(this,"handleMinimizeMessagingWindow",function(e,n){e||re.sendMessageToMessagingUI(re.uiMessagesEnum.WINDOW_MINIMIZED),n?(t.adbmsgContentContainerMnm.classList.remove("upwardAnimate"),t.adbmsgContentContainerMnm.classList.add("downwardAnimate")):(t.adbmsgContentContainer.classList.remove("upwardAnimate"),t.adbmsgContentContainer.classList.add("downwardAnimate"),zn.initJson&&zn.initJson.messagingWindowInTopLayer&&t.adbmsgContentContainer.hasAttribute("data-react-aria-top-layer")&&t.adbmsgContentContainer.removeAttribute("data-react-aria-top-layer")),zn.getMessagingWindowState()===zn.messagingWindowStateEnum.POPOUT&&(zn.setMessagingWindowState(zn.messagingWindowStateEnum.DOCKED),clearInterval(t.timer)),setTimeout(function(){t.adbmsgContentContainer.style.display="none",n&&(t.adbmsgContentContainerMnm.style.display="none")},250);var o=zn.serverInitResponse,i=o.authoredBotPopupModel,a=i&&i.controls.ctaImg?i.controls.ctaImg:"";zn.conversationActive||o.messagingState.assistantConversationExists?o.uiPolicy.showButtonAfterClose?t.showCTA(a):t.hideCTA():o.uiPolicy.showCTA?t.showCTA(a):t.hideCTA(),t.showConversationMarker(!1),t.isMobile()&&location.hash.includes("#messaging")&&(location.hash=location.hash.replace("#messaging",""))}),zt(this,"handleCloseMessagingWindow",function(e){t.handleMinimizeMessagingWindow(e),e&&(zn.isAdobeMessagingClientLoadStarted=!1)}),zt(this,"checkTabPress",function(e){var n=document.activeElement;if(null!==n)if(9===e.keyCode&&n.className.indexOf("adbmsgCta")>-1){-1===n.className.split(" ").indexOf("focus-ring")&&(n.className+=" focus-ring")}else{n=t.adbmsgCta;var o=new RegExp("\\bfocus-ring\\b","g");n.className=n.className.replace(o,"")}}),zt(this,"handleUserPrivacyConsent",function(){var e,n;zn.userConsent=!1;var o=Ht(t.checkConsentStatus(),2);return e=o[0],n=o[1],zn.userConsent=e,re.sendMessageToMessagingUI(re.uiMessagesEnum.UPDATE_USER_PRIVACY_CONSENT,zn.userConsent),zn.addedListeners.includes("adobePrivacy:PrivacyConsent")||(zn.addedListeners.push("adobePrivacy:PrivacyConsent"),window.addEventListener("adobePrivacy:PrivacyConsent",function(){zn.userConsent=!0,re.sendMessageToMessagingUI(re.uiMessagesEnum.UPDATE_USER_PRIVACY_CONSENT,!0)})),zn.addedListeners.includes("adobePrivacy:PrivacyCustom")||(zn.addedListeners.push("adobePrivacy:PrivacyCustom"),window.addEventListener("adobePrivacy:PrivacyCustom",function(){var o=Ht(t.checkConsentStatus(),2);e=o[0],n=o[1],zn.userConsent=e,re.sendMessageToMessagingUI(re.uiMessagesEnum.UPDATE_USER_PRIVACY_CONSENT,e)})),zn.addedListeners.includes("adobePrivacy:PrivacyReject")||(zn.addedListeners.push("adobePrivacy:PrivacyReject"),window.addEventListener("adobePrivacy:PrivacyReject",function(){zn.userConsent=!1,re.sendMessageToMessagingUI(re.uiMessagesEnum.UPDATE_USER_PRIVACY_CONSENT,!1)})),zn.addedListeners.includes("load")||(zn.addedListeners.push("load"),window.addEventListener("load",function(){var o=Ht(t.checkConsentStatus(),2);e=o[0],n=o[1],zn.userConsent=e,re.sendMessageToMessagingUI(re.uiMessagesEnum.UPDATE_USER_PRIVACY_CONSENT,e)})),Q.flushAnalyticsPipeline(),[e,n]}),zt(this,"checkConsentStatus",function(){var e=zn.serverInitResponse.defaultUserConsent,n="default";return t.isBlank(zn.serverInitResponse.userConsentFromSurface)?window.adobePrivacy?(e=t.getConsentStatusFromPrivacyObject(window.adobePrivacy),n="adobePrivacy"):zn.initJson.appid&&-1!==zn.serverInitResponse.surfacesWithConsentInCookies.indexOf(zn.initJson.appid.toLowerCase())&&(e=t.getConsentValueFromCookie(),n="cookies"):(e="true"===zn.serverInitResponse.userConsentFromSurface.toLowerCase(),n="initContext"),[e,n]}),zt(this,"getConsentStatusFromPrivacyObject",function(e){var t=zn.serverInitResponse.defaultUserConsent;if(e){var n=e.activeCookieGroups();if(n)t=!1,zn.serverInitResponse.consentLevels.find(function(e){return-1!==n.indexOf(e)})&&(t=!0)}return t}),zt(this,"getConsentStatusForGnavRollout",function(){var e=!0;return window.adobePrivacy&&(e=t.getConsentStatusFromPrivacyObject(window.adobePrivacy)),e}),zt(this,"getConsentCookieValue",function(){var e;if(document.cookie){var t,n=document.cookie.split(";").find(function(e){t=e.indexOf("=");var n=[e.substring(0,t),e.substring(t+1)],o=n[0];return o&&"optanonconsent"===o.trim().toLowerCase()});if(n){var o=[n.substring(0,t),n.substring(t+1)],i=o[1].split("&").find(function(e){var t=Ht(e.split("="),2),n=t[0];t[1];return n&&"groups"===n.trim()});if(i){var a=Ht(i.split("="),2);a[0];e=a[1]}}}return e}),zt(this,"getConsentValueFromCookie",function(){var e=zn.serverInitResponse.defaultUserConsent;try{var n=t.getConsentCookieValue();if(n){e=!1;var o=n.split("%2C").reduce(function(e,t){var n=Ht(t.split("%3A"),2),o=n[0],i=n[1];if(o&&i)return e[o.trim()]=i.trim(),e},{});zn.serverInitResponse.consentLevels.find(function(e){return"1"===o[e]})&&(e=!0)}}catch(e){D.log("Error while fetching consent value from cookie",e)}return e}),zt(this,"isBlank",function(e){return null==e||""===e.trim()}),zt(this,"handleCtaClick",function(e){var n;e.preventDefault(),e.stopPropagation();var o=document.getElementsByClassName("adbmsgContentIframe");void 0!==o&&o.length>0&&(o[0].style.pointerEvents="auto");var i=Ht(t.handleUserPrivacyConsent(),2);i[0],n=i[1],D.log("Consent status for appId "+zn.initJson.appid+" has been decided by "+n),zn.mnmMode?t.handleOpenZeonWindow():t.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"button",sourceText:"button"})}),zt(this,"simulateCTAClick",function(){t.timeoutCta&&(clearTimeout(t.timeoutCta),t.timeoutCta=void 0),zn.mnmMode?t.handleOpenZeonWindow():t.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"auto",sourceText:"button"})}),zt(this,"resizeDimension",function(){try{Fe.handleResizeDimension(),_e.handleResizeDimension();var e=document.getElementById("adbmsgContentContainer"),t=e.getBoundingClientRect(),n=window.innerWidth,o=window.innerHeight;if(t.left<0||t.right>n){var i=Math.max(Math.min(t.width,n),zn.minChatWidth);e.style.left=null,e.style.width=i+"px",e.style.right="0px"}if(t.top<0||t.bottom>o){var a=Math.max(Math.min(t.height,o),zn.chatMinHeight);e.style.top=null,e.style.height=a+"px",e.style.bottom="0px"}}catch(e){v.error("Error in resizeDimension",e)}}),zt(this,"removeJarvisElement",function(){var e=!0;try{t.adbMsgClientWrapper&&(t.adbMsgClientWrapper.parentNode.removeChild(t.adbMsgClientWrapper),re.setInitialServerPoliciesApplied(!1),re.setLoadCompletedState(!1),D.info("Successfully removed Jarvis element to re-render because of version change for appID: ",zn.initJson.appid," and client id: ",zn.initJson.clientId))}catch(t){e=!1,D.error("Exception in removing Jarvis Element with exception stack trace : ",t.stack," for appID: ",zn.initJson.appid," and client id: ",zn.initJson.clientId)}return e}),zt(this,"closeZeon",function(){try{t.adbmsgContentContainerMnm&&(t.handleMinimizeMessagingWindow(!1,!0),t.adbmsgContentContainerMnm.parentNode.removeChild(t.adbmsgContentContainerMnm),D.info("Successfully removed Zeon element"))}catch(e){D.error("Exception in removing Zeon Element with exception stack trace : ",e.stack)}}),zt(this,"renderZeonElement",function(){t.handleMinimizeMessagingWindow(!1,!1),t.adbmsgContentContainerMnm=fe.createElement("div","adbmsgContentContainerMnm",t.adbmsgContainer),t.adbmsgContentContainerMnm.id="adbmsgContentContainerMnm",t.adbmsgContentIframeMnm=fe.createElement("iframe","adbmsgContentIframeMnm",t.adbmsgContentContainerMnm),t.adbmsgContentIframeMnm.setAttribute("frameBorder",0),t.adbmsgContentIframeMnm.setAttribute("src",t.getMessagingClientHashedUrl()),t.hideCTA(),t.adbmsgContentContainerMnm.style.display="block",t.adbmsgContentIframeMnm.style.display="block",t.adbmsgContentContainer.style.display="none"}),zt(this,"setThemeCSS",function(e){var t=document.getElementById("adbmsgCta");return t&&t.classList?("light"===e?t.classList.contains("adbmsgCtaDarkest")&&t.classList.remove("adbmsgCtaDarkest"):"darkest"===e&&(t.classList.contains("adbmsgCtaDarkest")||t.classList.add("adbmsgCtaDarkest")),!0):(v.warn("adbmsgCtaElem or adbmsgCtaElem classList not found"),!1)}),zt(this,"showTooltip",function(e){return function(){clearTimeout(t.toolTipTimeout),t.toolTipTimeout=setTimeout(function(){e.style.display="block"},zn.getCtaToolTipDelay())}}),zt(this,"hideTooltip",function(e){return function(){clearTimeout(t.toolTipTimeout),t.toolTipTimeout=setTimeout(function(){e.style.display="none"},300)}}),zt(this,"renderJarvisElement",function(e){if(e.releaseControl.showAdobeMessaging){var n=zn.getMessagingUIURL();if(zn.handleInitResponse(e),!zn.reinitializePhase&&n&&n===e.releaseControl.adobeMessagingClientURL)return v.info("Received same messaging UI URL, thereofore not reloading for appID: ",zn.initJson.appid," and client id: ",zn.initJson.clientId),D.info("Received same messaging UI URL, thereofore not reloading for appID: ",zn.initJson.appid," and client id: ",zn.initJson.clientId),void t.applyInitialServerPolicies();var o=zn.serverInitResponse;if(t.removeJarvisElement()){var i=zn.serverInitResponse,a=zn.config.js_url;v.log("base_url : "+a),t.adbMsgClientWrapper=fe.createElement("div","adbMsgClientWrapper",document.body),t.adbMsgClientWrapper.id="adbMsgClientWrapper",t.adbmsgContainer=fe.createElement("div","adbmsgContainer",t.adbMsgClientWrapper),t.adbmsgContainer.id="adbmsgContainer",t.adbmsgContentContainer=fe.createElement("div","adbmsgContentContainer",t.adbmsgContainer),t.adbmsgContentContainer.id="adbmsgContentContainer",t.adbmsgContentHeader=fe.createElement("div","adbmsgContentHeader",t.adbmsgContentContainer),t.adbmsgContentIframe=fe.createElement("iframe","adbmsgContentIframe",t.adbmsgContentContainer),t.adbmsgCta=fe.createElement("button","adbmsgCta",t.adbmsgContainer),t.adbmsgCta.id="adbmsgCta",t.adbmsgCta.setAttribute("aria-label",i.localizedData.ctaText),t.adbmsgCta.classList.add("outwardAnimate"),"darkest"===zn.initJson.theme&&t.adbmsgCta.classList.add("adbmsgCtaDarkest"),zn.initJson&&zn.initJson.messagingWindowInTopLayer&&(t.adbmsgCta.hasAttribute("data-react-aria-top-layer")||t.adbmsgCta.setAttribute("data-react-aria-top-layer","true")),t.adbmsgbadge=fe.createElement("span","adbmsgbadge",t.adbmsgCta);var r=fe.createElement("p","adbmsg-tooltip",t.adbmsgCta),s=document.createTextNode(i.localizedData.ctaText);r.appendChild(s),t.adbmsgCta.addEventListener?(t.adbmsgCta.addEventListener("click",t.handleCtaClick,!1),t.adbmsgCta.addEventListener("mouseover",t.showTooltip(r)),t.adbmsgCta.addEventListener("focus",t.showTooltip(r)),t.adbmsgCta.addEventListener("blur",t.hideTooltip(r)),t.adbmsgCta.addEventListener("mouseleave",t.hideTooltip(r))):t.adbmsgCta.attachEvent&&(t.adbmsgCta.attachEvent("onclick",t.handleCtaClick),t.adbmsgCta.attachEvent("onmouseover",t.showTooltip(r)),t.adbmsgCta.attachEvent("onfocus",t.showTooltip(r)),t.adbmsgCta.attachEvent("onblur",t.hideTooltip(r)),t.adbmsgCta.attachEvent("onmouseleave",t.hideTooltip(r))),t.addPopUps(),o.uiPolicy.openMessagingWindow&&(zn.initJson.lazyLoad=!1),zn.initJson.lazyLoad?(t.addSpinner(),t.applyInitialServerPolicies()):t.loadIframeUI(),t.handleWindowClick(),t.handleWindowFocus(),t.resizeDimension(),window.addEventListener("resize",t.resizeDimension),t.handleDrag(),document.addEventListener("keyup",function(e){t.checkTabPress(e)},!1),document.addEventListener("mousedown",function(e){t.checkTabPress(e)},!1)}}}),zt(this,"handleDragWidth",function(e){"INCREASE"===e?t.adbmsgContentHeader.setAttribute("style","width: -moz-calc(100% - 80px); width: -webkit-calc(100% - 80px); width: -o-calc(100% - 80px); width: calc(100% - 80px);"):t.adbmsgContentHeader.setAttribute("style","width: -moz-calc(100% - 150px); width: -webkit-calc(100% - 150px); width: -o-calc(100% - 150px); width: calc(100% - 150px);")}),zt(this,"handleWindowFocus",function(){window.onfocus=function(){zn.isAdobeMessagingClientLoadStarted&&re.sendMessageToMessagingUI(re.uiMessagesEnum.CLIENT_FOCUS_STATE,{isInFocus:!0})},window.onblur=function(){zn.isAdobeMessagingClientLoadStarted&&re.sendMessageToMessagingUI(re.uiMessagesEnum.CLIENT_FOCUS_STATE,{isInFocus:!1})}}),zt(this,"handleWindowClick",function(){document.addEventListener("click",function(e){t.dragged?t.dragged=!1:zn.mnmMode?null!=document.getElementById("adbmsgContentContainerMnm")&&"block"==document.getElementById("adbmsgContentContainerMnm").style.display&&t.handleMinimizeMessagingWindow(!1,!0):null!=document.getElementById("adbmsgContentContainer")&&"block"==document.getElementById("adbmsgContentContainer").style.display&&t.handleMinimizeMessagingWindow(!1,!1)})}),zt(this,"handleDrag",function(){var e=0,n=0,o=0,i=0,a=zn.chatMinWidth+10,r=zn.chatMinHeight+10,s=function(s){r=t.adbmsgContentIframe.offsetHeight,a=t.adbmsgContentIframe.offsetWidth,(s=s||window.event).preventDefault&&s.preventDefault();var l=o+e-s.clientX;l<0&&(l=0),l+a>window.innerWidth&&(l=window.innerWidth-a);var c=i+n-s.clientY;c<0&&(c=0),c+r>window.innerHeight&&(c=window.innerHeight-r),t.adbmsgContentContainer.style.left=null,t.adbmsgContentContainer.style.top=null,t.adbmsgContentContainer.style.right=l+"px",t.adbmsgContentContainer.style.bottom=c+"px"},l=function(){r=t.adbmsgContentIframe.offsetHeight,a=t.adbmsgContentIframe.offsetWidth,e=0,o=0,n=0,i=0,t.adbmsgContentIframe.style.pointerEvents="auto",document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l),document.removeEventListener("mouseleave",l)};t.adbmsgContentHeader.addEventListener("mousedown",function(c){r=t.adbmsgContentIframe.offsetHeight+10,a=t.adbmsgContentIframe.offsetWidth+10,t.dragged=!0,(c=c||window.event).preventDefault&&c.preventDefault(),e=c.clientX,o=window.innerWidth-t.adbmsgContentContainer.offsetLeft-a,n=c.clientY,i=window.innerHeight-t.adbmsgContentContainer.offsetTop-r,t.adbmsgContentIframe.style.pointerEvents="none",document.addEventListener("mousemove",s),document.addEventListener("mouseup",l),document.addEventListener("mouseleave",l)})}),zt(this,"addPopUps",function(){t.showConversationMarker(!1);var e=zn.serverInitResponse;if("none"!=e.uiPolicy.ctaStyleOverride&&t.adbmsgCta.classList.add(e.uiPolicy.ctaStyleOverride),"none"!=e.uiPolicy.wndStyleOverride&&t.adbmsgContentContainer.classList.add(e.uiPolicy.wndStyleOverride),e.uiPolicy.yOffset){var n=e.uiPolicy.yOffset;!isNaN(n)&&n>0&&(t.adbmsgCta.style.bottom=n+"px")}e.messagingState.conversationExists||(e.tutorialPopUpModel&&tt.addTutorialPopUpToDOM(e,e.tutorialPopUpModel,t.adbmsgCta,t.adbmsgContainer),e.authoredBotPopupModel&&dt.addPopUpToDOM(e,e.authoredBotPopupModel,t.adbmsgCta,t.adbmsgContainer),e.autoRenewalPopupModel&&St.addPopUpToDOM(e,e.autoRenewalPopupModel,t.adbmsgCta,t.adbmsgContainer),e.engagementPopUpModel?_e.addEngagementPopUpToDOM(e,e.engagementPopUpModel,t.adbmsgCta,t.adbmsgContainer):e.showPopUp&&Fe.addSalesPopUpToDOM(e,t.adbmsgCta,t.adbmsgContainer))}),zt(this,"renderCTAasPerPolicy",function(e,n,o,i){e&&0!=e.uiPolicy.loadDelay?t.ctaDelayTimeout=setTimeout(function(){t.showCTA(o),Q.sendEvent({"event.workflow":"init","event.subcategory":"launch","event.type":"render","event.subtype":"read","content.name":"button","content.status":o},!1),t.showConversationMarker(n,i)},1e3*e.uiPolicy.loadDelay):(t.showCTA(o),t.showConversationMarker(n,i),Q.sendEvent({"event.workflow":"init","event.subcategory":"launch","event.type":"render","event.subtype":"read","content.name":"button","content.status":o},!1))}),zt(this,"applyInitialServerPolicies",function(){re.setInitialServerPoliciesApplied(!0),zn.setOnReadyStateAndTriggerPendingCallbacks();var e=zn.serverInitResponse;if(re.sendMessageToMessagingUI(re.uiMessagesEnum.SET_EXPANDED,e.messagingState.isExpanded),e.messagingState.conversationExists&&(zn.conversationActive=!0),e.uiPolicy.openMessagingWindow||e.messagingState.assistantConversationExists&&e.messagingState.isExpanded)t.hideCTA(),e.viaUpdateAccessTokenPath?D.info("Not creating session for conversation exists as it is via UpdateAccessToken Path for appid: ",zn.initJson.appid):t.handleOpenMessagingWindow({appid:zn.initJson.appid,appver:zn.initJson.appver,componentid:A.getClientAppId(),componentver:A.getClientVersion(),sourceType:"auto",sourceText:"button"});else if(e.messagingState.conversationExists||e.messagingState.assistantConversationExists){var n=e.authoredBotPopupModel,o=n&&n.controls.ctaImg?n.controls.ctaImg:"";e.uiPolicy.showCTA?t.renderCTAasPerPolicy(e,!0,o):(t.showCTA(o),e.showFullScreenMobile&&t.showConversationMarker(!0))}else if(zn.aepPopUp)Bt.addPopUpToDOM(zn.aepPopUp,t.adbmsgCta,t.adbmsgContainer),Bt.showPopUp();else{var i=e.engagementPopUpModel,a=e.tutorialPopUpModel,r=e.authoredBotPopupModel,s=e.autoRenewalPopupModel;i?(t.showCtaForEngagementPopup(i,e),t.showEngagementPopup(i,_e)):a?(t.showCtaForEngagementPopup(a,e),a.isTutorialPopupEnabled&&a.isTutorialPopupEligible?t.showEngagementPopup(a,tt):t.renderCTAasPerPolicy(e)):r?(t.showCtaForEngagementPopup(r,e),t.showEngagementPopup(r,dt)):s?(t.showCtaForEngagementPopup(s,e),t.showEngagementPopup(s,St)):(e.uiPolicy.showCTA?t.renderCTAasPerPolicy(e):t.hideCTA(),e.showPopUp&&e.popUpLoadDelay&&0!=e.popUpLoadDelay?setTimeout(function(){Fe.showSalesPopUp(!0)},1e3*e.popUpLoadDelay):Fe.showSalesPopUp(!0))}}),zt(this,"showCtaForEngagementPopup",function(e,n){if(e.controls.showCtaWithPopUp)if(n.uiPolicy.showCTA){var o=e.controls.showConversationMarker?"adbmsgCustombadge":void 0;t.renderCTAasPerPolicy(n,e.controls.showConversationMarker,e.controls.ctaImg,o)}else t.hideCTA()}),zt(this,"showEngagementPopup",function(e,t){var n=e.controls.loadDelay;n&&n>0?setTimeout(function(){t.showPopUp()},1e3*n):t.showPopUp()}),zt(this,"showConversationMarker",function(e,n){var o={},i=zn.serverInitResponse;e?zn.serverInitResponse.uiPolicy.showDotAfterClose&&(A.isHidden(t.adbmsgCta)||(t.badgeVisible||(Q.sendEvent({"event.workflow":"init","event.subcategory":"launch","event.type":"render","event.subtype":"unread","content.name":"button"}),o.badgeState=!0,t.adbmsgCta.setAttribute("aria-label",i.localizedData.newMessageFromAgentText),t.adbmsgCta.setAttribute("aria-live","polite")),t.badgeVisible=!0,t.adbmsgbadge.style.display="block",n&&""!=n&&(t.adbmsgbadge.classList.add(n),t.adbmsgbadge.textContent="1")),o.badgeState=!0,o.windowOpenState=A.isHidden(t.adbmsgCta),zn.initJson.callbacks.badgeStateCallback&&zn.initJson.callbacks.badgeStateCallback(o)):(t.badgeVisible=!1,t.adbmsgbadge.style.display="none",t.adbmsgbadge.classList.contains("adbmsgCustombadge")&&(t.adbmsgbadge.classList.remove("adbmsgCustombadge"),t.adbmsgbadge.textContent=""),o.badgeState=!1,t.adbmsgCta.setAttribute("aria-label",i.localizedData.ctaText),t.adbmsgCta.setAttribute("aria-live","off"),o.windowOpenState=!1,zn.initJson.callbacks.badgeStateCallback&&zn.initJson.callbacks.badgeStateCallback(o))}),zt(this,"applyHostOverrides",function(e){if(e){if(e.hasOwnProperty("cta")){var n=e.cta,o=t.adbmsgCta;o.classList.contains(n)||o.classList.add(n)}if(e.hasOwnProperty("wnd")){var i=e.wnd,a=t.adbmsgContentContainer;a.classList.contains(i)||a.classList.add(i)}}}),zt(this,"getMessagingExperienceState",function(){return{windowState:A.isHidden(t.adbmsgContentContainer)?"hidden":zn.messagingWindowState,ctaState:A.isHidden(t.adbmsgCta)?"hidden":"visible"}}),zt(this,"handlePopOut",function(){var e=t.adbmsgContentContainer.clientWidth,n=t.adbmsgContentContainer.clientHeight+22;(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox")>0||0===navigator.platform.toLowerCase().indexOf("win"))&&(n=t.adbmsgContentContainer.clientHeight),screen.height>620&&(n=Math.max(n,620));var o=screen.width/2-e/2,i="titlebar = no, top = "+(screen.height/2-n/2)+" , left = "+o+", height = "+n+" , width = "+e,a=zn.getMessagingWindowState();zn.setMessagingWindowState(zn.messagingWindowStateEnum.POPOUT);var r=window.open(t.getMessagingClientHashedUrl(),"",i);if(r){t.adbmsgContentContainer.style.display="none",t.hideCTA();var s=t.handleCloseMessagingWindow;t.poppedWindow=r,window.onbeforeunload=function(){t.poppedWindow&&(t.poppedWindow.close(),t.poppedWindow=null)};var l=setInterval(function(){r&&r.closed&&(clearInterval(l),t.poppedWindow=null,s())},100);t.timer=l}else zn.setMessagingWindowState(a)}),zt(this,"handlePopIn",function(){zn.setMessagingWindowState(zn.messagingWindowStateEnum.DOCKED),clearInterval(t.timer),t.poppedWindow.close(),t.poppedWindow=null,t.adbmsgContentContainer.style.display="block",t.hideCTA(),re.sendMessageToMessagingUI(re.uiMessagesEnum.WINDOW_OPENED)}),this.poppedwindow,this.timer,this.adbmsgCta=void 0,this.adbmsgbadge=void 0,this.adbmsgContentContainer=void 0,this.adbmsgContentContainerMnm=void 0,this.adbmsgContentHeader=void 0,this.adbmsgContentIframe=void 0,this.adbmsgContentIframeMnm=void 0,this.openedInFullScreenMode=!1,this.timeoutCta=void 0,this.dragged=!1,this.toolTipTimeout=void 0});const Xt=new Kt;function qt(e){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(e)}function Zt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,$t(o.key),o)}}function $t(e){var t=function(e,t){if("object"!=qt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=qt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qt(t)?t:t+""}var Yt=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appid,this.appver,this.appType="web",this.componentid,this.componentver,this.env="prod",this.surfaceFeatures=[],this.language,this.region,this.clientId="",this.accessToken,this.fontRequired=!1,this.theme="light",this.userRole="",this.loadedVia="",this.userConsent=!0,this.userConsentFromSurface="",this.cookies={},this.context={orgId:"",userData:{},companyName:"",greetContext:""},this.otherContext={},this.callbacks={signInProvider:null,initCallback:null,initErrorCallback:null,getContextCallback:null,onReadyCallback:null,analyticsCallback:null,chatStateCallback:null,badgeStateCallback:null,openURLActionCallback:null},this.userAgent,this.url,this.msgdebug=!1,this.lazyLoad=!1,this.messagingWindowInTopLayer=!1,this.mobileOnly=Xt.isMobile(!0)},(t=[{key:"validateAndModifyContext",value:function(e){null!=e&&null!=e&&(this.appid=e.appid||this.appid,this.appver=e.appver||this.appver,this.clientId=e.clientId||this.clientId,this.accessToken=e.accessToken||this.accessToken,this.componentid=e.componentid||this.componentid,this.componentver=e.componentver||this.componentver,this.language=e.language||this.language,this.region=e.region||this.region,this.userConsent=e.userConsent||this.userConsent,this.mobileOnly=e.mobileOnly||this.mobileOnly,e.userConsentFromSurface&&(this.userConsentFromSurface=e.userConsentFromSurface),e.loadedVia&&(this.loadedVia=e.loadedVia),e.greetContext&&(this.context.greetContext=e.greetContext),e.userRole&&(this.userRole=e.userRole),e.companyName&&(this.context.companyName=e.companyName||this.context.companyName),e.hasOwnProperty("surfaceFeatures")&&Array.isArray(e.surfaceFeatures)&&(this.surfaceFeatures=e.surfaceFeatures),e.orgId&&(this.context.orgId=e.orgId))}},{key:"validateAndInitContext",value:function(e){if(!(e.appid&&e.appver&&e.language&&e.region&&e.clientId))throw"Missing context params";if(this.appid=e.appid,this.appver=e.appver,this.appType=e.appType||this.appType,this.componentid=e.componentid||this.appid,this.componentver=e.componentver||this.appver,this.env=e.env||this.env,this.language=e.language,this.region=e.region,this.userConsent=e.userConsent||this.userConsent,this.mobileOnly=e.mobileOnly||this.mobileOnly,e.userConsentFromSurface&&(this.userConsentFromSurface=e.userConsentFromSurface),this.clientId=e.clientId,this.hostContext=e.hostContext,this.hostId=e.hostId,this.accessToken=e.accessToken||"",this.accessToken&&0===!this.accessToken.toLowerCase().indexOf("bearer"))throw"Bearer accesstoken required";e.loadedVia&&(this.loadedVia=e.loadedVia),e.fontRequired&&(this.fontRequired=e.fontRequired),this.cookies=e.cookies||{},this.theme=e.theme||this.theme,this.otherContext=e.otherContext||this.otherContext,e.context&&(this.context.orgId=e.context.orgId||"",this.context.userData=e.context.userData||{},this.context.companyName=e.context.companyName||""),e.callbacks&&(this.callbacks.signInProvider=e.callbacks.signInProvider,this.callbacks.initCallback=e.callbacks.initCallback,this.callbacks.initErrorCallback=e.callbacks.initErrorCallback,this.callbacks.onReadyCallback=e.callbacks.onReadyCallback,this.callbacks.getContextCallback=e.callbacks.getContextCallback,this.callbacks.analyticsCallback=e.callbacks.analyticsCallback,this.callbacks.chatStateCallback=e.callbacks.chatStateCallback,this.callbacks.badgeStateCallback=e.callbacks.badgeStateCallback,this.callbacks.openURLActionCallback=e.callbacks.openURLActionCallback),e.msgdebug&&(this.msgdebug=e.msgdebug),e.analyticsServerEnv&&(this.analyticsServerEnv=e.analyticsServerEnv),this.url=window.location.href,this.userAgent=navigator.userAgent,e.userRole&&(this.userRole=e.userRole),e.hasOwnProperty("lazyLoad")&&(this.lazyLoad="true"===e.lazyLoad.toString().toLowerCase()),e.hasOwnProperty("surfaceFeatures")&&Array.isArray(e.surfaceFeatures)&&(this.surfaceFeatures=e.surfaceFeatures),e.hasOwnProperty("messagingWindowInTopLayer")&&(this.messagingWindowInTopLayer="true"===e.messagingWindowInTopLayer.toString())}},{key:"updateAccessToken",value:function(e){this.accessToken=e}},{key:"updateUITheme",value:function(e){this.theme=e}}])&&Zt(e.prototype,t),n&&Zt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Qt(e){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qt(e)}function en(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,an(o.key),o)}}function tn(e,t,n){return t&&en(e.prototype,t),n&&en(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function on(e,t,n){return(t=an(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function an(e){var t=function(e,t){if("object"!=Qt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Qt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qt(t)?t:t+""}var rn=tn(function e(t){nn(this,e),on(this,"label",""),on(this,"action",""),on(this,"url",""),on(this,"key",""),on(this,"greetContext",""),on(this,"variant","primary"),this.label=t.label,"openURL"===t.action&&(this.url=t.url),this.action=t.action,this.key=t.key,t.variant&&(this.variant=t.variant)}),sn=tn(function e(t){if(nn(this,e),on(this,"viewType",""),on(this,"theme",""),on(this,"content",""),on(this,"body",""),on(this,"iconURL",""),on(this,"header",""),on(this,"controls",{showCtaWithPopUp:!1,loadDelay:0}),on(this,"footer",{buttons:[]}),on(this,"analyticsInfo",{}),this.viewType=t.viewType,this.content=t.content,t.body&&(this.body=t.body),t.iconURL&&(this.iconURL=t.iconURL),t.theme&&(this.theme=t.theme),t.header)this.header=t.header;else if(t.iconPath){var n=A.getJarvisClientRootUrlByEnv();this.iconURL="".concat(n).concat(t.iconPath)}else t.useRandomAgentIcon&&(this.iconURL=A.getRandomAvatarUrl());t.controls&&(t.controls.hasOwnProperty("showCtaWithPopUp")&&(this.controls.showCtaWithPopUp=t.controls.showCtaWithPopUp),t.controls.hasOwnProperty("loadDelay")&&(this.controls.loadDelay=t.controls.loadDelay)),t.footer&&(t.footer.buttons&&Array.isArray(t.footer.buttons)&&t.footer.buttons.length>0&&(this.footer.buttons=t.footer.buttons.map(function(e){return new rn(e)})),t.footer.link&&(this.footer.link=new rn(t.footer.link))),t.analyticsInfo&&(this.analyticsInfo=t.analyticsInfo)});function ln(e){return ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ln(e)}function cn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,mn(o.key),o)}}function pn(e,t,n){return t&&cn(e.prototype,t),n&&cn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function un(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dn(e,t,n){return(t=mn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mn(e){var t=function(e,t){if("object"!=ln(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=ln(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ln(t)?t:t+""}var gn=pn(function e(t){un(this,e),dn(this,"label",""),dn(this,"action",""),dn(this,"url",""),dn(this,"key",""),dn(this,"variant","primary"),this.label=t.label,"openURL"===t.action&&(this.url=t.url),this.action=t.action,this.key=t.key,t.variant&&(this.variant=t.variant)}),fn=pn(function e(t){un(this,e),dn(this,"viewType",""),dn(this,"content",""),dn(this,"body",""),dn(this,"header",""),dn(this,"controls",{showCtaWithPopUp:!1,loadDelay:0}),dn(this,"footer",{buttons:[]}),dn(this,"analyticsInfo",{}),this.viewType=t.viewType,this.content=t.content,t.body&&(this.body=t.body),t.header&&(this.header=t.header),t.controls&&(t.controls.hasOwnProperty("showCtaWithPopUp")&&(this.controls.showCtaWithPopUp=t.controls.showCtaWithPopUp),t.controls.hasOwnProperty("loadDelay")&&(this.controls.loadDelay=t.controls.loadDelay)),t.footer&&(t.footer.buttons&&Array.isArray(t.footer.buttons)&&t.footer.buttons.length>0&&(this.footer.buttons=t.footer.buttons.map(function(e){return new gn(e)})),t.footer.link&&(this.footer.link=new gn(t.footer.link))),t.analyticsInfo&&(this.analyticsInfo=t.analyticsInfo),this.isTutorialPopupEnabled=t.isTutorialPopupEnabled,this.isTutorialPopupEligible=t.isTutorialPopupEligible,this.isTutorialPopupGethelpEnabled=t.isTutorialPopupGethelpEnabled});function bn(e){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bn(e)}function vn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Pn(o.key),o)}}function yn(e,t,n){return t&&vn(e.prototype,t),n&&vn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function hn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cn(e,t,n){return(t=Pn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pn(e){var t=function(e,t){if("object"!=bn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=bn(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bn(t)?t:t+""}var wn=yn(function e(t){hn(this,e),Cn(this,"label",""),Cn(this,"action",""),Cn(this,"url",""),Cn(this,"key",""),Cn(this,"variant","primary"),this.label=t.label,"openURL"===t.action&&(this.url=t.url),this.action=t.action,this.key=t.key,t.variant&&(this.variant=t.variant)}),En=yn(function e(t){hn(this,e),Cn(this,"viewType",""),Cn(this,"content",""),Cn(this,"body",""),Cn(this,"header",""),Cn(this,"controls",{showCtaWithPopUp:!0,loadDelay:0,showConversationMarker:!1}),Cn(this,"footer",{buttons:[]}),Cn(this,"analyticsInfo",{}),this.viewType=t.viewType,this.content=t.content,t.body&&(this.body=t.body),t.header&&(this.header=t.header),t.controls&&(t.controls.hasOwnProperty("showCtaWithPopUp")&&(this.controls.showCtaWithPopUp=t.controls.showCtaWithPopUp),t.controls.hasOwnProperty("loadDelay")&&(this.controls.loadDelay=t.controls.loadDelay),t.controls.hasOwnProperty("ctaImg")&&""!==t.controls.ctaImg&&(this.controls.ctaImg=t.controls.ctaImg),t.controls.hasOwnProperty("showConversationMarker")&&(this.controls.showConversationMarker=t.controls.showConversationMarker),t.controls.hasOwnProperty("playAudio")&&(this.controls.playAudio=t.controls.playAudio),t.controls.hasOwnProperty("loadDelay")&&""!==t.controls.loadDelay&&(this.controls.loadDelay=parseInt(t.controls.loadDelay))),t.footer&&t.footer.buttons&&Array.isArray(t.footer.buttons)&&t.footer.buttons.length>0&&(this.footer.buttons=t.footer.buttons.map(function(e){return new wn(e)})),t.analyticsInfo&&(this.analyticsInfo=t.analyticsInfo),this.isAuthoredBotPopupEligible=t.isAuthoredBotPopupEligible,this.isPageVisitSalesPopUpEnabled=t.isPageVisitSalesPopUpEnabled});function Sn(e){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(e)}function An(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,kn(o.key),o)}}function In(e,t,n){return t&&An(e.prototype,t),n&&An(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Un(e,t,n){return(t=kn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kn(e){var t=function(e,t){if("object"!=Sn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Sn(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Sn(t)?t:t+""}var Mn=In(function e(t){Tn(this,e),Un(this,"label",""),Un(this,"action",""),Un(this,"url",""),Un(this,"key",""),Un(this,"variant","primary"),Un(this,"customGreet",""),this.label=t.label,"openURL"===t.action&&(this.url=t.url),this.action=t.action,this.key=t.key,t.variant&&(this.variant=t.variant),t.customGreet&&(this.customGreet=t.customGreet)}),On=In(function e(t){Tn(this,e),Un(this,"viewType",""),Un(this,"content",""),Un(this,"body",""),Un(this,"header",""),Un(this,"controls",{showCtaWithPopUp:!1,loadDelay:0,showConversationMarker:!1}),Un(this,"footer",{buttons:[]}),Un(this,"analyticsInfo",{}),this.viewType=t.viewType,this.content=t.content,t.body&&(this.body=t.body),t.header&&(this.header=t.header),t.controls&&(t.controls.hasOwnProperty("showCtaWithPopUp")&&(this.controls.showCtaWithPopUp=t.controls.showCtaWithPopUp),t.controls.hasOwnProperty("showConversationMarker")&&(this.controls.showConversationMarker=t.controls.showConversationMarker),t.controls.hasOwnProperty("loadDelay")&&""!==t.controls.loadDelay&&(this.controls.loadDelay=parseInt(t.controls.loadDelay))),t.footer&&t.footer.buttons&&Array.isArray(t.footer.buttons)&&t.footer.buttons.length>0&&(this.footer.buttons=t.footer.buttons.map(function(e){return new Mn(e)})),t.analyticsInfo&&(this.analyticsInfo=t.analyticsInfo)});function _n(e){return _n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_n(e)}function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function Rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(n),!0).forEach(function(t){jn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Dn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Nn(o.key),o)}}function jn(e,t,n){return(t=Nn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nn(e){var t=function(e,t){if("object"!=_n(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=_n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_n(t)?t:t+""}var xn=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),jn(this,"setShowAdobeMessaging",function(e){t.releaseControl.showAdobeMessaging=e}),jn(this,"setDefaultUserConsent",function(e){t.defaultUserConsent=null===e||"boolean"!=typeof e||e}),jn(this,"setConsentLevels",function(e){e&&(t.consentLevels=e)}),jn(this,"setSurfacesWithConsentInCookies",function(e){e&&(t.surfacesWithConsentInCookies=e)}),jn(this,"setUserConsentFromSurface",function(e){t.userConsentFromSurface=e}),jn(this,"setPopupStats",function(e){e&&(t.popupStats=e)}),this.customerType="consumer",this.isAgentAvailable=!0,this.fallbackLocale="en_US",this.uiFallbackLocale="en_US",this.agentFallbackLocale="en_US",this.enterpriseTeamLocale="",this.cookieGuid="",this.messagingState={windowState:"docked",conversationExists:!1,assistantConversationExists:!1,isExpanded:!1},this.localizedData={},this.uiPolicy={loadDelay:0,showCTA:!0,openMessagingWindow:!0,ctaStyleOverride:null,wndStyleOverride:null,ctaFadeInDelay:0,ctaFadeOutDelay:0,ctaTransparency:0,showButtonAfterClose:!0,showDotAfterClose:!0,popOutEnabled:!0,soundEnabled:!0,wndType:"full"},this.releaseControl={showLegacy:!1,showAdobeMessaging:!1,adobeMessagingClientURL:"",zeonURL:"",assistantUiURL:"",floodgateData:{}},this.showPopUp=!1,this.popUpLoadDelay=0,this.ipAddress="",this.iframeTitle="",this.showFullScreenMobile="",this.engagementPopUpModel=null,this.viaUpdateAccessTokenPath=!1,this.ctaToolTipDelay=2e3,this.defaultUserConsent=!1,this.consentLevels=["C0002"],this.surfacesWithConsentInCookies=["stockplansindividuals","unified_checkout_client","unified_checkout_client_app_v3","unified_checkout_client_v3","react_edit_billing_app_client","react_edit_billing_app_client_inapp"],this.userConsentFromSurface="",this.analyticsInfo=null,this.popupStats=[]},(t=[{key:"setResponse",value:function(e){this.customerType=e.customerType||this.customerType,this.isAgentAvailable=e.isAgentAvailable||this.isAgentAvailable,this.fallbackLocale=e.fallbackLocale||this.fallbackLocale,this.uiFallbackLocale=e.uiFallbackLocale||this.uiFallbackLocale,this.cookieGuid=e.cookieGuid||this.cookieGuid,this.ipAddress=e.ipAddress||this.ipAddress,this.iframeTitle=e.iframeTitle||this.iframeTitle,this.showFullScreenMobile=e.showFullScreenMobile||this.showFullScreenMobile,e.agentFallbackLocale&&null!=e.agentFallbackLocale?this.agentFallbackLocale=e.agentFallbackLocale||this.agentFallbackLocale:this.agentFallbackLocale=this.fallbackLocale,this.messagingState=Rn(Rn({},this.messagingState),e.messagingState),this.localizedData=Rn(Rn({},this.localizedData),e.localizedData),this.uiPolicy=Rn(Rn({},this.uiPolicy),e.uiPolicy),this.releaseControl=Rn(Rn({},this.releaseControl),e.releaseControl),this.showPopUp=e.showPopUp||this.showPopUp,this.ctaToolTipDelay=parseInt(e.ctaToolTipDelay,10)||this.ctaToolTipDelay,this.popUpLoadDelay=e.popUpLoadDelay||this.popUpLoadDelay,e.enterpriseTeamLocale&&(this.enterpriseTeamLocale=e.enterpriseTeamLocale),e.engagementPopUp?this.engagementPopUpModel=new sn(e.engagementPopUp):this.engagementPopUpModel=null,this.tutorialPopUpModel=e.tutorialPopUp?new fn(e.tutorialPopUp):null,this.authoredBotPopupModel=e.genericbotpopup?new En(e.genericbotpopup):null,this.autoRenewalPopupModel=e.autorenewalpopup?new On(e.autorenewalpopup):null,e.hasOwnProperty("viaUpdateAccessTokenPath")&&(this.viaUpdateAccessTokenPath=e.viaUpdateAccessTokenPath),this.analyticsInfo=e.analyticsInfo||null,this.setPopupStats(e.popupStats)}}])&&Dn(e.prototype,t),n&&Dn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Bn(e){return Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bn(e)}function Wn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function Hn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Fn(o.key),o)}}function Jn(e,t,n){return(t=Fn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fn(e){var t=function(e,t){if("object"!=Bn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Bn(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Bn(t)?t:t+""}var Gn={DOCKED:"docked",POPOUT:"popout"};const zn=new(function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Jn(this,"getAppVersion",function(){return t.appver}),Jn(this,"setMessagingWindowState",function(e){t.messagingWindowState=e}),Jn(this,"getMessagingWindowState",function(){return t.messagingWindowState}),Jn(this,"getMessagingUIURL",function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?t.serverInitResponse.releaseControl.zeonURL:t.serverInitResponse.releaseControl.adobeMessagingClientURL}),Jn(this,"updateInitContext",function(e){t.initJson.validateAndModifyContext(e)}),Jn(this,"updateUITheme",function(e){t.initJson.updateUITheme(e)}),Jn(this,"updateAccessToken",function(e){t.initJson.updateAccessToken(e)}),Jn(this,"handleInitData",function(e){t.initJson.validateAndInitContext(e),t.msgdebug=e.msgdebug,t.env=t.initJson.env,t.chatOpenedInThisTab=e.chatOpenedInThisTab}),Jn(this,"handleInitResponse",function(e){t.serverInitResponse.setResponse(e),t.messagingWindowState=t.serverInitResponse.messagingState.windowState}),Jn(this,"getCtaToolTipDelay",function(){return t.serverInitResponse.ctaToolTipDelay}),Jn(this,"setOnReadyStateAndTriggerPendingCallbacks",function(){t.isAdobeMessagingClientReady=!0,l.sendMessageToHost(l.hostCallbacks.TRIGGER_ON_READY_CALLBACKS)}),Jn(this,"getContextInfo",function(){var e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wn(Object(n),!0).forEach(function(t){Jn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wn(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t.initJson);return delete e.callbacks,e.context.conversationExists=t.serverInitResponse.messagingState.conversationExists,e.context.uiFallbackLocale=t.serverInitResponse.uiFallbackLocale,e.context.agentFallbackLocale=t.serverInitResponse.agentFallbackLocale,e.context.enterpriseTeamLocale=t.serverInitResponse.enterpriseTeamLocale,e.popOutEnabled=t.serverInitResponse.uiPolicy.popOutEnabled,e.soundEnabled=t.serverInitResponse.uiPolicy.soundEnabled,e.floodgateData=t.serverInitResponse.releaseControl.floodgateData,e.cookieGuid=t.serverInitResponse.cookieGuid,e.ipAddress=t.serverInitResponse.ipAddress,e.analyticsContext=t.getAnalyticsContext(),e}),Jn(this,"setInitConfig",function(e){t.initConfig=e}),Jn(this,"setInitSuccess",function(e){t.initSuccess=e}),Jn(this,"getInitSuccess",function(){return t.initSuccess}),Jn(this,"getCommonAnalyticsParams",function(){return{"event.category":t.initJson.appType.toUpperCase(),"event.url":location.href,"event.referrer":document.referrer,"event.user_agent":navigator.userAgent,"source.version":t.initJson.appver,"source.platform":t.initJson.appType,"source.os_version":"","env.com.name":A.getClientAppId(),"env.com.version":A.getClientVersion(),"event.ip":t.serverInitResponse.ipAddress}}),this.isAdobeMessagingClientReady=!1,this.isAdobeMessagingClientLoadStarted=!1,this.initJson=new Yt,this.serverInitResponse=new xn,this.config={},this.appid="AdobeMessaging",this.appver="3.9.23",this.conversationActive=!1,this.env="prod",this.messagingWindowState=this.messagingWindowStateEnum.DOCKED,this.initStarted=!1,this.msgdebug=!1,this.userProfile={},this.leConversationId="",this.vendorConversationId="",this.clientSessionId="",this.skillName="",this.initConfig={},this.zeonData={},this.mnmMode=!1,this.reinitializePhase=!1,this.userConsent=void 0,this.addedListeners=[],this.analyticsPipeline=[],this.initSuccess=!1,this.minChatWidth=380,this.maxChatHeight=580,this.chatOpenedInThisTab=!1,this.aepPopUp=null,this.aepCampaigns=null},(t=[{key:"messagingWindowStateEnum",get:function(){return Gn}},{key:"getAnalyticsContext",value:function(){return this.serverInitResponse.tutorialPopUpModel?this.serverInitResponse.tutorialPopUpModel.analyticsInfo:this.serverInitResponse.analyticsInfo||void 0}}])&&Hn(e.prototype,t),n&&Hn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());function Vn(e){return Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vn(e)}function Kn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Xn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){s=!0,a=e},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw a}}}}function Xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function qn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Yn(o.key),o)}}function Zn(e,t,n){return t&&qn(e.prototype,t),n&&qn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $n(e,t,n){return(t=Yn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yn(e){var t=function(e,t){if("object"!=Vn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Vn(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Vn(t)?t:t+""}const Qn=new(Zn(function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$n(this,"initializeAEP",function(){try{var e;if("undefined"!=typeof window&&window._satellite)return v.log("[AEP] Adobe Launch already loaded by client - using existing instance"),t.aepEnabled=!0,Promise.resolve();if(!1===(null===(e=zn.initConfig)||void 0===e||null===(e=e.aep)||void 0===e?void 0:e.autoLoadWebSDK))return Promise.reject(new Error("WebSDK not available by host and auto-load is disabled"));v.log("[AEP] Adobe Launch not found - loading dynamically as fallback...");var n=t.getAEPEnvironmentConfig();return n?(window.marketingtech={adobe:{launch:{url:n.launchURL,controlPageLoad:!0,disablePageUnload:!1},alloy:{edgeConfigId:n.edgeConfigId},target:!0,audienceManager:!0},sophia:!1,marketingTags:{disableGlobalTags:!1,disableContentsquare:!1}},window.alloy_all=window.alloy_all||{},window.alloy_all.data=window.alloy_all.data||{},window.alloy_all.data._adobe_corpnew=window.alloy_all.data._adobe_corpnew||{},window.alloy_all.data._adobe_corpnew.web=window.alloy_all.data._adobe_corpnew.web||{},window.alloy_all.data._adobe_corpnew.web.webPageDetails=window.alloy_all.data._adobe_corpnew.web.webPageDetails||{},new Promise(function(e,n){var o=document.createElement("script");o.src="https://www.adobe.com/marketingtech/main.standard.min.js",o.async=!0,o.onload=function(){v.log("[AEP] Adobe Launch script loaded successfully");var o=0,i=function(){o++,window._satellite?(t.aepEnabled=!0,v.log("[AEP] _satellite ready after ".concat(50*o,"ms")),e()):o>=100?(v.error("[AEP] _satellite not available after max attempts"),n(new Error("_satellite not available after timeout"))):setTimeout(i,50)};i()},o.onerror=function(e){v.error("[AEP] Failed to load Adobe Launch script:",e),n(e)},document.head.appendChild(o)})):(v.error("[AEP] Cannot initialize AEP - config not available in initConfig.json"),Promise.reject(new Error("AEP config not available")))}catch(e){return v.error("[AEP] Error initializing AEP:",e),Promise.reject(e)}}),$n(this,"getAEPEnvironmentConfig",function(){var e,t=null===(e=zn.initConfig)||void 0===e?void 0:e.aep;return null!=t&&t.launchURL&&null!=t&&t.edgeConfigId?(v.log("[AEP] Using AEP config from initConfig.json"),{launchURL:t.launchURL,edgeConfigId:t.edgeConfigId}):(v.error("[AEP] AEP config not found in initConfig.json. Ensure aep.launchURL and aep.edgeConfigId are configured."),null)}),$n(this,"isEnabled",function(){return t.aepEnabled&&void 0!==window._satellite}),$n(this,"getECID",function(){return new Promise(function(e,t){if(!window.alloy_getIdentity)return v.warn("[AEP] window.alloy_getIdentity not available"),void t(new Error("alloy_getIdentity not available"));window.alloy_getIdentity.then(function(t){var n,o=null==t||null===(n=t.identity)||void 0===n?void 0:n.ECID;v.log("[AEP] ECID:",o),e(o)}).catch(function(e){v.error("[AEP] Error fetching ECID:",e),t(e)})})}),$n(this,"sendDecisioningRequest",function(e){if(!t.isEnabled())return v.warn("[AEP] AEP not enabled, cannot send decisioning request"),Promise.reject(new Error("AEP not enabled"));try{var n,o,i,a=e.appid,r=e.language,s=e.region,l=e.locale,c={},p="";if(null!==(n=zn.userProfile)&&void 0!==n&&n.userGuid)c={adobeGUID:[{id:null===(i=zn.userProfile)||void 0===i?void 0:i.userGuid,authenticatedState:"authenticated",primary:!0}]},p="loggedIn";else p="loggedOut";var u={eventType:"decisioning.propositionFetch",identityMap:c,_adobe_corpnew:{context:{jarvis:{appID:a,language:r,region:s,locale:l}},digitalData:{primaryUser:{primaryProfile:{profileInfo:{authState:p}}}}}},d=null===(o=zn.initConfig)||void 0===o||null===(o=o.aep)||void 0===o?void 0:o.surfaces;return v.log("[AEP] Sending propositionFetch request"),v.log("[AEP] Surfaces:",d),v.log("[AEP] XDM Context:",u),new Promise(function(e,n){var o=setTimeout(function(){n(new Error("[AEP] Timeout waiting for propositionFetch response"))},1e4);window._satellite.track("propositionFetch",{personalization:{surfaces:d},data:{},xdm:u,done:function(i,a){var r,s,l,c;if(clearTimeout(o),a)return v.error("[AEP] propositionFetch error:",a),void n(a);v.log("[AEP] propositionFetch success - Full result:",i);var p=(null==i?void 0:i.decisions)||[];v.log("[AEP] Received decisions count:",p.length),p.length>0?(v.log("[AEP] Sending propositionDisplay for analytics/CJA"),window._satellite.track("propositionDisplay",p)):v.warn("[AEP] No decisions returned from AJO for surfaces:",d);var u=t.parseDecisionsBySurface(p);v.log("[AEP] Parsed by surface:",u);var m={greet:{odinUrl:(null===(r=u.greet)||void 0===r?void 0:r.odinUrl)||"",campaignInformation:(null===(s=u.greet)||void 0===s?void 0:s.campaignInformation)||""},popup:{odinUrl:(null===(l=u.popup)||void 0===l?void 0:l.odinUrl)||"",campaignInformation:(null===(c=u.popup)||void 0===c?void 0:c.campaignInformation)||""}};v.log("[AEP] Final result - greet:",m.greet),v.log("[AEP] Final result - popup:",m.popup),e(m)}})})}catch(e){return v.error("[AEP] Error in sendDecisioningRequest:",e),Promise.reject(e)}}),$n(this,"parseDecisionsBySurface",function(){var e,t={greet:null,popup:null},n=Kn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);try{for(n.s();!(e=n.n()).done;){var o=e.value,i=o.scope||"",a=null;if(i.includes("GreetSurface")||i.includes("engagementPopUrl")?a="greet":i.includes("PopUpSurface")&&(a="popup"),a&&o.items){var r,s=Kn(o.items);try{for(s.s();!(r=s.n()).done;){var l=r.value;if(l.data){var c,p=null;if("string"==typeof l.data.content)try{p=JSON.parse(l.data.content),v.log("[AEP] Parsed content string:",p)}catch(e){v.warn("[AEP] Failed to parse content string:",e)}else"object"===Vn(l.data.content)&&(p=l.data.content);var u=(null===(c=p)||void 0===c?void 0:c.odinUrl)||"",d="";if(o.scopeDetails){var m,g,f,b=o.scopeDetails;d={campaignId:(null===(m=b.activity)||void 0===m||null===(m=m.id)||void 0===m?void 0:m.split("#")[0])||"",actionId:(null===(g=b.activity)||void 0===g||null===(g=g.id)||void 0===g?void 0:g.split("#")[1])||"",treatmentId:(null===(f=b.strategies)||void 0===f||null===(f=f[0])||void 0===f?void 0:f.treatmentID)||"",surfaceId:i||""}}t[a]={odinUrl:u,campaignInformation:d},v.log("[AEP] Found ".concat(a," surface data:"),t[a])}}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){n.e(e)}finally{n.f()}return t}),this.aepEnabled=!1})),eo=JSON.parse('{"serverUrl":"localhost:9000","wsUrl":"localhost:9000","callAfterUpdateAccessToken":true,"aep":{"launchURL":"https://assets.adobedtm.com/d4d114c60e50/a0e989131fd5/launch-2c94beadc94f-development.min.js","edgeConfigId":"3a30d55c-d57d-4851-af18-634780f03357","surfaces":["web://jarvis#GreetSurface","web://jarvis#PopUpSurface","web://jarvis#engagementPopUrl"],"autoLoadWebSDK":false}}');function to(e){return to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},to(e)}function no(e){return function(e){if(Array.isArray(e))return oo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return oo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oo(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function io(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function ao(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?io(Object(n),!0).forEach(function(t){uo(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):io(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ro(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function a(n,o,i,a){var l=o&&o.prototype instanceof s?o:s,c=Object.create(l.prototype);return so(c,"_invoke",function(n,o,i){var a,s,l,c=0,p=i||[],u=!1,d={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,s=0,l=e,d.n=n,r}};function m(n,o){for(s=n,l=o,t=0;!u&&c&&!i&&t<p.length;t++){var i,a=p[t],m=d.p,g=a[2];n>3?(i=g===o)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=m&&((i=n<2&&m<a[1])?(s=0,d.v=o,d.n=a[1]):m<g&&(i=n<3||a[0]>o||o>g)&&(a[4]=n,a[5]=o,d.n=g,s=0))}if(i||n>1)return r;throw u=!0,o}return function(i,p,g){if(c>1)throw TypeError("Generator is already running");for(u&&1===p&&m(p,g),s=p,l=g;(t=s<2?e:l)||!u;){a||(s?s<3?(s>1&&(d.n=-1),m(s,l)):d.n=l:d.v=l);try{if(c=2,a){if(s||(i="next"),t=a[i]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),s=1);a=e}else if((t=(u=d.n<0)?l:n.call(o,d))!==r)break}catch(t){a=e,s=1,l=t}finally{c=1}}return{value:t,done:u}}}(n,i,a),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var p=[][o]?t(t([][o]())):(so(t={},o,function(){return this}),t),u=c.prototype=s.prototype=Object.create(p);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,so(e,i,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=c,so(u,"constructor",c),so(c,"constructor",l),l.displayName="GeneratorFunction",so(c,i,"GeneratorFunction"),so(u),so(u,i,"Generator"),so(u,o,function(){return this}),so(u,"toString",function(){return"[object Generator]"}),(ro=function(){return{w:a,m:d}})()}function so(e,t,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}so=function(e,t,n,o){function a(t,n){so(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},so(e,t,n,o)}function lo(e,t,n,o,i,a,r){try{var s=e[a](r),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,i)}function co(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){var a=e.apply(t,n);function r(e){lo(a,o,i,r,s,"next",e)}function s(e){lo(a,o,i,r,s,"throw",e)}r(void 0)})}}function po(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,mo(o.key),o)}}function uo(e,t,n){return(t=mo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mo(e){var t=function(e,t){if("object"!=to(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=to(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==to(t)?t:t+""}var go=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),uo(this,"initializeAndFetchAEPPopup",co(ro().m(function e(){var n;return ro().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Qn.initializeAEP();case 1:return v.log("[AEP] AEP initialization complete"),e.n=2,t.fetchAEPPopup();case 2:e.n=4;break;case 3:e.p=3,n=e.v,v.error("[AEP] AEP initialization failed:",n);case 4:return e.a(2)}},e,null,[[0,3]])}))),uo(this,"initSuccessNextSteps",function(e){zn.reinitializePhase=!1,e.analyticsInfo&&(zn.analyticsInfo=e.analyticsInfo),Xt.handleUserPrivacyConsent(),Q.sendEvent({"event.workflow":"init","event.type":"response","event.subtype":"success"},!1),Q.sendEvent({"event.workflow":"init","event.type":"userconsent","event.subtype":zn.userConsent},!0)}),uo(this,"handleInitSuccess",function(e){try{v.log("got successful response from server for init call: ",e);var n,o,i=JSON.parse(e),a={};a.releaseControl=ao({},i.releaseControl),zn.serverInitResponse.setShowAdobeMessaging(a.releaseControl.showAdobeMessaging),zn.serverInitResponse.setDefaultUserConsent(i.defaultUserConsent),zn.serverInitResponse.setConsentLevels(i.consentLevels),zn.serverInitResponse.setSurfacesWithConsentInCookies(i.surfacesWithConsentInCookies),zn.serverInitResponse.setUserConsentFromSurface(i.userConsentFromSurface),zn.serverInitResponse.setPopupStats(i.popupStats),zn.setInitSuccess(!0),l.sendMessageToHost(l.hostCallbacks.INIT_SUCCESS_CALLBACK,a),i.userProfileInfo&&(zn.userProfile=i.userProfileInfo),i.releaseControl.showAdobeMessaging?null!=i.releaseControl.assistantUiURL?null!==(n=i.messagingState)&&void 0!==n&&n.conversationExists||null!==(o=i.messagingState)&&void 0!==o&&o.assistantConversationExists?(Xt.renderJarvisElement(i),t.initSuccessNextSteps(i)):t.initializeAndFetchAEPPopup().finally(function(){Xt.renderJarvisElement(i),t.initSuccessNextSteps(i)}):(v.log("[AEP] Assistant UI URL not found, skipping AEP initialization"),Xt.renderJarvisElement(i),t.initSuccessNextSteps(i)):(Xt.removeJarvisElement(),t.initSuccessNextSteps(i))}catch(t){v.error("exception in handling init call response with response text: ",e,"and exception: ",t," and stack trace: ",t.stack),D.error("exception in handling init call response with response text: ",e,"and exception: ",t," and stack trace: ",t.stack)}}),uo(this,"handleInitError",function(e){zn.reinitializePhase=!1,zn.setInitSuccess(!1),Xt.removeJarvisElement(),l.sendMessageToHost(l.hostCallbacks.INIT_ERROR_CALLBACK,e),Xt.handleUserPrivacyConsent(),Q.sendEvent({"event.workflow":"init","event.type":"response","event.subtype":"error","event.error_code":e},!1),Q.sendEvent({"event.workflow":"init","event.type":"userconsent","event.subtype":zn.userConsent},!0)}),uo(this,"makeInitCallToServer",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getContextForServerInitCall(e);v.log("Sending context object to server : "+JSON.stringify(n));var o={type:"post",url:zn.initConfig.serverUrl+m.INIT_API_PATH,headers:{"Content-Type":"application/json","x-api-key":zn.initJson.clientId,Accept:"application/json"},withCredentials:!0};o.data=n,o.timeout=12e4,M.ajax(t.handleInitSuccess,t.handleInitError,o)}),uo(this,"initializeServer",function(e){if(e=JSON.parse(e),"local"===zn.env&&(e=eo),zn.setInitConfig(e),zn.chatOpenedInThisTab)return v.log("Messaging client already opened in this tab, returning error"),void D.log("Messaging client already opened in this tab, returning error");re.startListening(),t.makeInitCallToServer()}),uo(this,"_getCookies",function(){}),uo(this,"initialize",function(e){try{if(zn.initStarted)return v.log("Messaging client already initialized, returning error"),t.makeInitResponse("error");n(993),zn.initStarted=!0,e.msgdebug=!(!e.msgdebug&&"true"!==t.getQueryStringValue("msgdebug")),e.theme=t.getQueryStringValue("jarvisUITheme")||e.theme,e.chatOpenedInThisTab="true"===t.getQueryStringValue("ctsrd");var o=e.analyticsServerEnv||t.getQueryStringValue("analyticsServerEnv");if(o&&(e.analyticsServerEnv=o),!e.accessToken){var i=t.getQueryStringValue("jarvisUserId");i&&(e.accessToken="Fake "+i)}e.userConsent=Xt.getConsentStatusForGnavRollout(),zn.handleInitData(e),l.initializeCallbacks(),v.log("Messaging Client version: "+zn.getAppVersion()),Q.initialize("messaging-web-service",zn.env,"dunamis");var a=A.getJarvisClientRootUrlByEnv();if(document.querySelector("script[src]")&&document.querySelector("script[src]").src){var r=no(document.querySelectorAll("script[src]")).find(function(e){return e.src.includes(A.getClientFileByEnv())});if(r){var s=new URL(r.src);a=s.origin+s.pathname.substring(0,s.pathname.lastIndexOf("/"))}}var c={type:"get",url:"".concat(a,"/initConfig.json"),headers:{"Content-Type":"application/json"},withCredentials:!1};M.ajax(t.initializeServer,t.handleInitError,c);var p=zn.chatOpenedInThisTab?"error":"success";return t.makeInitResponse(p)}catch(e){return v.error(e),t.makeInitResponse("error")}}),uo(this,"updateUITheme",function(e){var t=["light","darkest"];if(e&&t.includes(e)){if(Xt.setThemeCSS(e))return zn.updateUITheme(e),re.sendMessageToMessagingUI(re.uiMessagesEnum.UPDATE_UI_THEME,e),!0;v.error("adbmsgCtaElem or adbmsgCtaElem classList not found")}else e?v.error("Theme provided is not from allowed theme ".concat(t)):v.error("Theme provided is null");return!1}),uo(this,"updateAccessToken",function(e){v.log("Received updated access token from surface for appid: ",zn.initJson.appid,"and client id: ",zn.initJson.clientId),zn.updateAccessToken(e),re.sendMessageToMessagingUI(re.uiMessagesEnum.UPDATE_ACCESS_TOKEN,e),zn.isAdobeMessagingClientLoadStarted||zn.initConfig&&zn.initConfig.hasOwnProperty("callAfterUpdateAccessToken")&&"false"!==zn.initConfig.callAfterUpdateAccessToken.toString().toLowerCase()&&(v.log("Session not started for user and therefore re-making init call"),l.sendMessageToHost(l.hostCallbacks.INIT_ERROR_CALLBACK,500),D.info("Going to make init call after update access token for client id: ",zn.initJson.clientId," with url: ",location.href),t.makeInitCallToServer(!0))}),uo(this,"reinitialize",function(e){return v.log("Received reinitialize from surface for appid: ",zn.initJson.appid,"and client id: ",zn.initJson.clientId," with data: ",e),D.log("Received reinitialize from surface for appid: ",zn.initJson.appid,"and client id: ",zn.initJson.clientId," with data: ",D.mask(e)),e&&!zn.isAdobeMessagingClientLoadStarted?(zn.reinitializePhase=!0,zn.updateInitContext(e),t.makeInitCallToServer(!1),t.makeInitResponse("success")):e&&e.userConsentFromSurface?(zn.serverInitResponse.setUserConsentFromSurface(e.userConsentFromSurface),Xt.handleUserPrivacyConsent(),t.makeInitResponse("error")):t.makeInitResponse("error")}),uo(this,"makeInitResponse",function(e){var t={status:"success",type:"init_started"};if("error"===e){var n=zn.getInitSuccess()?"init_already_done":"init_failed";t={status:"error",type:n=zn.chatOpenedInThisTab?"multiple_chatwindow_attempted":n}}return t}),uo(this,"updateSurfaceFeatures",function(e){Array.isArray(e)&&(zn.initJson.surfaceFeatures=e)}),uo(this,"openMessagingWindow",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;zn.isAdobeMessagingClientReady?setTimeout(function(){D.info("Received openMessagingWindow call from surface for appid: ",zn.initJson.appid," and client id: ",zn.initJson.clientId," with url: ",location.href),zn.mnmMode?(D.log("MnM mode enabled, Opening Zeon Window"),Xt.handleOpenZeonWindow()):(D.log("Opening Jarvis Window"),Xt.handleOpenMessagingWindow(e))},500):(D.warn("Ignoring openMessagingWindow call from surface as Messaging is not ready."),v.warn("Ignoring openMessagingWindow call from surface as Messaging is not ready."))}),uo(this,"closeMessageWindow",function(){zn.isAdobeMessagingClientReady?Xt.handleCloseMessagingWindow():v.warn("Ignoring closeMessageWindow call from surface as Messaging is not ready.")}),uo(this,"isConversationOpen",function(){return zn.conversationActive}),uo(this,"isChatWindowOpened",function(){var e=zn.mnmMode?Xt.adbmsgContentContainerMnm:Xt.adbmsgContentContainer;return"block"===(e&&e.style.display)}),uo(this,"updateUserConsent",function(e){}),uo(this,"applyExperienceOverride",function(e){Xt.applyHostOverrides(e)}),uo(this,"showCTA",function(){Xt.showCTA()}),uo(this,"hideCTA",function(){Xt.hideCTA()}),uo(this,"getUiPolicy",function(){if(zn.serverInitResponse&&zn.serverInitResponse.uiPolicy){var e=zn.serverInitResponse.uiPolicy;return{showCTA:e.showCTA,yOffset:e.yOffset,showButtonAfterClose:e.showButtonAfterClose,popOutEnabled:e.popOutEnabled,wndType:e.wndType}}return null}),uo(this,"registerForOnReadyCallback",function(e){l.registerForOnReadyCallback(e)}),uo(this,"isAdobeMessagingClientInitialized",function(){return!!zn.isAdobeMessagingClientReady}),uo(this,"isAdobeMessagingClientEnabled",function(){return!!zn.serverInitResponse&&zn.serverInitResponse.releaseControl.showAdobeMessaging}),uo(this,"handleSignIn",function(e){re.sendMessageToMessagingUI(re.uiMessagesEnum.SIGNIN,e)}),uo(this,"handleSignOut",function(){re.sendMessageToMessagingUI(re.uiMessagesEnum.SIGNOUT)}),uo(this,"getMessagingExperienceState",function(){return Xt.getMessagingExperienceState()}),uo(this,"fetchAEPPopup",co(ro().m(function e(){var t,n,o,i,a,r,s,l,c,p,u,d,m;return ro().w(function(e){for(;;)switch(e.p=e.n){case 0:if(v.log("[AEP] Starting fetching AEP popup ..."),Qn.isEnabled()){e.n=1;break}return v.warn("[AEP] AEP not ready, skipping popup fetch"),e.a(2);case 1:if(!zn.isAdobeMessagingClientLoadStarted){e.n=2;break}return v.log("[AEP] Chat window already open, skipping popup"),e.a(2);case 2:return t={appid:zn.initJson.appid||"test",language:zn.initJson.language||"en_US",region:zn.initJson.region||"US",locale:zn.initJson.locale||"en_US"},v.log("[AEP] Sending decisioning request for popup:",t),e.p=3,e.n=4,Qn.sendDecisioningRequest(t);case 4:if(l=e.v,v.log("[AEP] Decisioning result:",l),c={"event.workflow":"AEPInvitationPopUp","event.type":"eligibility","event.subtype":"ajo_popup","event.user_guid":null===(n=zn.userProfile)||void 0===n?void 0:n.userGuid,"event.visitor_guid":A.getECIDFromAMCVCookie(),"exp.campaign_id":null===(o=l.popup)||void 0===o||null===(o=o.campaignInformation)||void 0===o?void 0:o.campaignId,"exp.surface_id":null===(i=l.popup)||void 0===i||null===(i=i.campaignInformation)||void 0===i?void 0:i.surfaceId,"exp.treatment_id":null===(a=l.popup)||void 0===a||null===(a=a.campaignInformation)||void 0===a?void 0:a.treatmentId},zn.aepCampaigns=l,v.log("eventObj",c),Q.sendEvent(c),p=(null===(r=l.popup)||void 0===r?void 0:r.odinUrl)||"",u=(null===(s=l.popup)||void 0===s?void 0:s.campaignInformation)||"",!p){e.n=8;break}return v.log("[AEP] Found popup odinUrl:",p),e.p=5,e.n=6,Bt.initializeWithAEPResult({odinUrl:p,campaignInformation:u});case 6:v.log("[AEP] Popup initialization complete"),e.n=8;break;case 7:e.p=7,d=e.v,v.error("[AEP] Error initializing popup:",d);case 8:e.n=10;break;case 9:e.p=9,m=e.v,v.error("[AEP] Error in popup decisioning request:",m);case 10:return e.a(2)}},e,null,[[5,7],[3,9]])})))},t=[{key:"getQueryStringValue",value:function(e){return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}},{key:"getContextForServerInitCall",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=ao({},zn.initJson);t.clientVersion=A.getClientVersion(),t.viaUpdateAccessTokenPath=e;var n=A.getECIDFromAMCVCookie();return n&&(t.ecid=n),t}},{key:"sendHostData",value:function(e){var t=!0;for(var n in e)if(e.hasOwnProperty(n)){t=!1;break}null!=e&&null!=e&&!1===t?re.sendMessageToMessagingUI(re.uiMessagesEnum.HOST_DATA,e):v.log("HostData is null")}}],t&&po(e.prototype,t),o&&po(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,o}();window.AdobeMessagingExperienceClient?v.error("Object AdobeMessagingExperienceClient already exists with url: ",location.href):window.AdobeMessagingExperienceClient=new go})(),o})());